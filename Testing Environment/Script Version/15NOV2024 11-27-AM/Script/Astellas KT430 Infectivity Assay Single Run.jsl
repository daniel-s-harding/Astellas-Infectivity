// (c) Thomas A. Little Consulting 2023
//01/04/2024 created script
//02/14/2024 updated to combine results of 3 assay runs
//03/07/2024 updated infectious particle ratio nominal dose equation
//03/07/2024 updated to include accepted droplets check


//Clear all variables
Clear Globals();

scriptver = "Astellas KT430 PLA Script Version 0.1";

pathlocation = Pick Directory ("Select a directory.");
Set Default Directory(pathlocation);

dateint = Char( As Date( Today() ) );
datetimestamper = Substitute( Char( dateint ), ":", "-" );


CreatePLADir_Astellas= expr(
	if(!directory exists(concat(pathlocation,"Astellas KT430 RI Assay Results")),create directory(concat(pathlocation,"Astellas KT430 RI Assay Results")));
	if(!directory exists(concat(pathlocation,"Astellas KT430 RI Assay Results\Journals")),create directory(concat(pathlocation,"Astellas KT430 RI Assay Results\Journals")));
	if(!directory exists(concat(pathlocation,"Astellas KT430 RI Assay Results\PDFs")),create directory(concat(pathlocation,"Astellas KT430 RI Assay Results\PDFs")));
	if(!directory exists(concat(pathlocation,"Astellas KT430 RI Assay Results\Tables")),create directory(concat(pathlocation,"Astellas KT430 RI Assay Results\Tables")));
	if(!directory exists(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking")),create directory(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking")));
    if(!File Exists(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 RI Assay Tracking and Trending.jmp")),
		dttracking = New Table( "Astellas KT430 RI Assay Tracking and Trending",
			Add Rows( 0 ),
			Compress File When Saved( 1 ),
			New Column( "Script Date and Time",
				Numeric,
				"Continuous",
				Format( "yyyy-mm-ddThh:mm:ss", 23, 0 ),
				Input Format( "m/d/y h:m:s", 0 ),
				Set Values( [] ),
				Set Display Width( 213 )
			),
			New Column( "Script Version",
				Character,
				"Nominal",
				Set Values( {} ),
				Set Display Width( 279 )
			),
			New Column( "Configuration File Name",
				Character,
				"Nominal",
				Set Values( {} ),
				Set Display Width( 279 )
			),
			New Column( "Assay Name",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 362 )
			),		
			New Column( "Reference Standard",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 362 )
			),
			New Column( "Date Assay Initiated",
				Character( 20 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 160 )
			),
			New Column( "Purpose",
				Character,
				"Nominal",
				Set Values( {} ),
				Set Display Width( 166 )
			),
			New Column( "Bioassay Run ID",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 141 )
			),			
			New Column( "Analyst Name",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 141 )
			),
			New Column( "Bioassay Preparation",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 141 )
			),
			New Column( "Bioassay Revision",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 141 )
			),
			New Column( "Signal",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 157 )
			),
			New Column( "Method",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 118 )
			),
			New Column( "Instrument ID",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 118 )
			),
			New Column( "Notes", Character( 31 ), "Nominal", Set Display Width( 200 ) ),
			New Column( "Material 1", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 1", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 1", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 1", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 1",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Material 2", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 2", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 2", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 2", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 2",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Material 3", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 3", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 3", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 3", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 3",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Material 4", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 4", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 4", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 4", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 4",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Material 5", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 5", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 5", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 5", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 5",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Material 6", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 6", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 6", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 6", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 6",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Material 7", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 7", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 7", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 7", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 7",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Material 8", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Source 8", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Catalog 8", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Lot 8", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "Expiration 8",
				Character( 31 ),
				"Nominal",
				Set Display Width( 67 )
			),
			New Column( "Reference Standard ID",
				Character( 31 ),
				"Nominal",
				Set Display Width( 147 )
			),
			New Column( "RS Description",
				Character( 31 ),
				"Nominal",
				Set Display Width( 82 )
			),
			New Column( "RS Expiry", Character( 31 ), "Nominal", Set Display Width( 60 ) ),
			New Column( "RS CF",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Display Width( 72 )
			),
			New Column( "Stability CF",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Display Width( 72 )
			),	
			New Column( "Test Article Information",
				Character,
				"Nominal",
				Set Values( {} ),
				Set Display Width( 174 )
			),	
			New Column( "EC50 Reference",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),				
			New Column( "EC50 TA",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Parallelism, Slope Ratio",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Linearity Ratio",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Dose Test",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Selected Model",
				Character( 31 ),
				"Nominal",
				Set Values( {} ),
				Set Display Width( 118 )
			),
			New Column( "EC50 Fixed Setpoint",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Display Width( 112 )
			),
			New Column( "EC50 Reference Fixed",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Reference Standard Curve Depth",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Relative Infectivity Delta",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Unconstrained RI",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Reportable RI",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "RI Upper 95",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "RI Lower 95",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Infectious Particles Ratio",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Failed Accepted Droplets",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "CI 95% Range", Numeric, "Continuous", Set Values( [] ), Set Display Width( 213 ) ),
		New Column( "CI Range as % of Tolerance", Numeric, "Continuous", Set Values( [] ), Set Display Width( 213 ) ),
			New Column( "Assay Validity",
				Character,
				"Nominal",
				Set Values( {} ),
				Set Display Width( 113 )
			),
			New Column( "Delta to Target",
				Numeric,
				"Continuous",
				Format( "Fixed Dec", 12, 1 ),
				Set Display Width( 213 )
			)
	);


		dttracking << save(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 RI Assay Tracking and Trending.jmp"));
		close(dttracking);
	);
		    if(!File Exists(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 Aggregate Raw Data Table.jmp")),
		dtconcat = New Table( "Biosentinel  DS Aggregate Raw Data Table",
			Add Rows( 0 ),
			Compress File When Saved( 1 ),
			New Column( "Group",
				Character,
				"Nominal",
				Set Values( {} ),
				Set Display Width( 174 )
			),			
			New Column( "Sampling",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),	
			New Column( "N Rows",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Vg/mL",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),		
			New Column( "MOI",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),			
			New Column( "Log10 MOI",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Log10 Vg/mL",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Jackknife z",
				Numeric,
				"Continuous",
				Format( "Best", 12 ),
				Set Values( [] ),
				Set Display Width( 113 )
			),
			New Column( "Outlier Within Group",
				Character,
				"Nominal",
				Set Values( {} ),
				Set Display Width( 113 )
			)
		);
		dtconcat << save(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 Aggregate Raw Data Table.jmp"));
		close(dtconcat);
	);

	
);

CreatePLADir_Astellas;


 //astellas logo
astellaslogo = New Image(
	Char To Blob(
		"iVBORw0KGgoAAAANSUhEUgAABQAAAAFfCAYAAAARc2HGAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAABmJLR0QA/wD/AP+gvaeTAACAAElEQVR42uzdd3gc1dUG8PfMbFFzoxlwwxjbsk23DbhQTLclYaoCASTtrowCJA4pBEhIsqlAQpoTkii2diUByReRhIALNbEDtkwNBmJsugu9ualYW+Z8f0iAMS4qO7uzs+/vefyA5dWUc+/M3Hv2zr0AERH12uLFi0vvuef+wxgJIiIiIiIiciqDISAi6p3Fixdfoop/AB3vMhpERERERETkVEwAEhH1wqJFi65QxR2AbJ09e/Y2RoSIiIiIiIiciglAIqIeWrRo0VcA+WPXPXQ9I0JEREREREROxgQgEVEPLF68+HJAfg1AOn+i6xgVIiIiIiIicjImAImIumnx4sWzVRHZ8d4pgnWMDBERERERETkZE4BERN2wePHiM1TxVwCeHX9uWXiT0SEiIiIiIiInYwKQiGgvlixZMl4VdwHw7+KfNzFCRERERERE5GRMABIR7cHChQv3syy9F8CAXX/C2swoERERERERkZMxAUhEtBtLly7NEzHvBTBqd58Rkc2MFBERERERETkZE4BERLvR2tq6ANApe/qMqm5hpIiIiIiIiMjJmAAkItqFxYsXzwXk0r19TlU5ByARERERERE5GhOAREQ7Wbhw4XGq+Hl3Pisi2xgxIiIiIiIicjIPQ0BE9KlFixYNAuT/APi683kRSTJqRERERERE5GQcAUhE1EVVRUQaAIxkNIiIiIiIiMgtmAAkIuqyZMmSq1RR1pPf8fv9FiNHRERERERETsYEIBERgCVLloxS1Zt7+nttbW1MABIREREREZGjMQFIRDlv6dKlHsvSOwEp6unvdnT0V0aQiIiIiIiInIwJQCLKea2t7TcAOL43v+v3bxVGkIiIiIiIiJyMCUAiymn33HPfkYB+t7e/7/f7ixhFIiIiIiIicjImAIkoZ4XDYcM0rT8A8PZ2G8lksh8jSURERERERE7GBCAR5azJkydfCWBqX7ahqkwAEhERERERkaMxAUhEOWnx4sUHquLHKdhUf0aTiIiIiIiInIwJQCLKSar6WwAD+7odEWECkIiIiIiIiByN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",
		"base64"
	),
	"png"
);

//Set the fonts for the pdf report
fontpref = Get Preferences( fonts );//get user font preferences
Set Preferences(
	Fonts(
		English(
			Text Font( "Segoe UI", 13 ),
			Heading Font( "Segoe UI", 12, Bold ),
			Title Font( "Segoe UI", 14, Bold ),
			Small Font( "Segoe UI", 12 ),
			Monospaced Font( "Segoe UI", 13 ),
			Formula Font( "Segoe UI", 14 ),
			Annotation Font( "Segoe UI", 12 ),
			Axis Font( "Segoe UI", 12 ),
			Marker Font( "Segoe UI", 12 ),
			Axis Title Font( "Segoe UI", 12 ),
			Data Table Font( "Segoe UI", 12 )
		)
	)
);

Set Preferences( Background Color( 2 ) );

tablestyles = Get Preferences(
	Shade Table Headings(),
	Table Heading Column Borders(),
	Table Column Borders(),
	Table Column Group Borders(),
	Table Row Borders(),
	Shade Alternate Table Rows()
);
Set Preferences(
	Shade Table Headings( 1 ),
	Table Heading Column Borders( 1 ),
	Table Column Borders( 1 ),
	Table Column Group Borders( 1 ),
	Table Row Borders( 1 ),
	Shade Alternate Table Rows( 1 )
);

// Setup Criteria
//create variable for spacing in the report
spacer = " ";

//create date and time variables to record the date and time the script is run
datestamper = Long Date( Today() );
dateint = Char( As Date( Today() ) );
timestamp = MDYHMS( Today() );
timestamp1 = Num( timestamp );

//create variables for lines in the report
liner =
"_______________________________________________________________________________________________________________________________________________________________________";
dashliner = "____________________________________________________________________________________________________";


//Get user information of the person running the script including server information jmp version etc
usernamer = Get Environment Variable( "username" );//grabs windows variable username and sets usernamer variable
computernamer = Get Environment Variable( "computername" );//grabs windows variable computername and sets  computername variable
logonserverr = Get Environment Variable( "logonserver" );//grabs windows variable logonserver and sets logonserverr variable
jmpreport = JMP Version();
userdomainr = Get Environment Variable( "userdomain" );//grabs windows variable userdomainr and setsuserdomainr  variable
usernamedisplay = Concat( "User Name: ", usernamer );//concatenate "User Name:"  and usernamer variable for report displays
userdomaindisplay = Concat( "User Domain: ", userdomainr );//concatenate "User Domain:"  and userdomainr variable for report displays
computernamedisplay = Concat( "Computer Name: ", computernamer );//concatenate "Computer Name:"  and computernamer variable for report displays
logonserverdisplay = Concat( "Logon Server: ", logonserverr );//concatenate "Logon Server:"  and logonserverr variable for report displays

// Get the data requirements from the user
//a GUI appears and the user selects the appropriate completed excel material template

//create list for the dataflie and the configuration file
datafilelist=list();
configfilelist=list();



k=1;

			
configurator = Pick File(
	"Select  Infectivity Configuration File",
	"",
	{"All Files|*"},
	1,
	0,
	""
);


//import the excel material template as a data table and name the plate map	
Open(configurator, invisible);	
configfile =configurator;			
positionA = Contains( configfile , "/" , -1);//finds first position for file name
datafilenamenopath = Substr( configfile, positionA+1 );//subtracts folder path from file name

positionB = Contains( datafilenamenopath, "." );//finds last position for file name
confignamer = Substr( datafilenamenopath, 1, positionB - 1 );//final template file name

//create variables for all columns in the sample and materials info tab of the excel template
dtconfig = Current Data Table();
column1details = Column( 1 ) << get values;
column2details = Column( 2 ) << get values;
column3details = Column( 3 ) << get values;

//Dynamically read in the Systems Suitability and Validity Criteria from the materials template//Specification Limits
RPLSL=num(column2details[1]);
RPUSL=num(column2details[2]);

//Curve Depth Limit
curvedepthlimit = Num( column2details[3] );


//Unconstrained EC50 Limit for the standard
EC50reflowerlimit = Num( column2details[4] );
EC50refupperlimit = Num( column2details[5] );

//Constrained - Unconstrained Relative Infectivity difference (delta) Limit
RPDeltalimit = Num( column2details[6] );


//Outlier Limit; Values less than this number will be marked as outliers by comparison to the Jackknife z 
outlierlimitnum = Num( column2details[7] );

//Between Group Externally Studentized Residuals Outlier Limit
studoutlierlimitnum = Num( column2details[8] );

//Parallelism Slope ratio lower limit 
lowerparallel_limit = Num( column2details[9] );

//Parallelism Slope ratio upper limit 
upperparallel_limit = Num( column2details[10] );


//Linearity Ratio lower limit
linearity_limit = Num( column2details[11] );

//Dose Reponse Test (≤)
Doselimit = Num( column2details[12] );

//fixed position
fixedRFER = Num( column2details[13] );

//fixed TA log value	
fixedTAvalue =Num( column2details[14] );


//Infectious Particles Ratio LSL
infectpartLSL = Num( column2details[15] );

//Infectious Particles Ratio USL
infectpartUSL = Num( column2details[16] );

//Failed Accepted Droplets Limit
	dropletscountlimit = Num( column2details[17] );

//report file name
filenamer = column2details[19];

//Test Sample names and information
SN1=column2details[20];
SN2=column2details[21];
SN3=column2details[22];
SN4=column2details[23];
SN5=column2details[24];
SN6=column2details[25];
SN7=column2details[26];

snlist={SN1,SN2,SN3,SN4,SN5,SN6,SN7};
	
finalsnlist=List();

//Make the SN list
for(i=1, i<=7,i++,
	if(eval(snlist[i])=="",a=1+2,finalsnlist[i]=eval(snlist[i]));
);


rstandard = column2details[20];
platetotal =  column2details[28];

Current Data Table(dtconfig );

samplesperplate = Column(4) << get values;
pmcolumn1details = Column (6)  << get values;
pmcolumn2details = Column (7) << get values;
pmcolumn3details = Column (8) << get values;
pmcolumn4details = Column (9) << get values;
pmcolumn5details = Column (10) << get values;
pmcolumn6details = Column (11) << get values;
pmcolumn7details = Column (12) << get values;
pmcolumn8details = Column (13) << get values;
pmcolumn9details = Column (14) << get values;
pmcolumn10details = Column (15) << get values;
pmcolumn11details = Column (16) << get values;
pmcolumn12details = Column (17) << get values;

//Universal Names and Locations for the first plate
//A Row
A1name = (pmcolumn1details[1]);
A2name = (pmcolumn2details[1]);
A3name = (pmcolumn3details[1]);
A4name = (pmcolumn4details[1]);
A5name = (pmcolumn5details[1]);
A6name = (pmcolumn6details[1]);
A7name = (pmcolumn7details[1]);
A8name = (pmcolumn8details[1]);
A9name = (pmcolumn9details[1]);
A10name = (pmcolumn10details[1]);
A11name = (pmcolumn11details[1]);
A12name = (pmcolumn12details[1]);

	//B Row
B1name = (pmcolumn1details[2]);
B2name = (pmcolumn2details[2]);
B3name = (pmcolumn3details[2]);
B4name = (pmcolumn4details[2]);
B5name = (pmcolumn5details[2]);
B6name = (pmcolumn6details[2]);
B7name = (pmcolumn7details[2]);
B8name = (pmcolumn8details[2]);
B9name = (pmcolumn9details[2]);
B10name = (pmcolumn10details[2]);
B11name = (pmcolumn11details[2]);
B12name = (pmcolumn12details[2]);

	//C Row
C1name = (pmcolumn1details[3]);
C2name = (pmcolumn2details[3]);
C3name = (pmcolumn3details[3]);
C4name = (pmcolumn4details[3]);
C5name = (pmcolumn5details[3]);
C6name = (pmcolumn6details[3]);
C7name = (pmcolumn7details[3]);
C8name = (pmcolumn8details[3]);
C9name = (pmcolumn9details[3]);
C10name = (pmcolumn10details[3]);
C11name = (pmcolumn11details[3]);
C12name = (pmcolumn12details[3]);

	//D Row
D1name = (pmcolumn1details[4]);
D2name = (pmcolumn2details[4]);
D3name = (pmcolumn3details[4]);
D4name = (pmcolumn4details[4]);
D5name = (pmcolumn5details[4]);
D6name = (pmcolumn6details[4]);
D7name = (pmcolumn7details[4]);
D8name = (pmcolumn8details[4]);
D9name = (pmcolumn9details[4]);
D10name = (pmcolumn10details[4]);
D11name = (pmcolumn11details[4]);
D12name = (pmcolumn12details[4]);

	//E Row
E1name = (pmcolumn1details[5]);
E2name = (pmcolumn2details[5]);
E3name = (pmcolumn3details[5]);
E4name = (pmcolumn4details[5]);
E5name = (pmcolumn5details[5]);
E6name = (pmcolumn6details[5]);
E7name = (pmcolumn7details[5]);
E8name = (pmcolumn8details[5]);
E9name = (pmcolumn9details[5]);
E10name = (pmcolumn10details[5]);
E11name = (pmcolumn11details[5]);
E12name = (pmcolumn12details[5]);

	//F Row
F1name = (pmcolumn1details[6]);
F2name = (pmcolumn2details[6]);
F3name = (pmcolumn3details[6]);
F4name = (pmcolumn4details[6]);
F5name = (pmcolumn5details[6]);
F6name = (pmcolumn6details[6]);
F7name = (pmcolumn7details[6]);
F8name = (pmcolumn8details[6]);
F9name = (pmcolumn9details[6]);
F10name = (pmcolumn10details[6]);
F11name = (pmcolumn11details[6]);
F12name = (pmcolumn12details[6]);

	//G Row
G1name = (pmcolumn1details[7]);
G2name = (pmcolumn2details[7]);
G3name = (pmcolumn3details[7]);
G4name = (pmcolumn4details[7]);
G5name = (pmcolumn5details[7]);
G6name = (pmcolumn6details[7]);
G7name = (pmcolumn7details[7]);
G8name = (pmcolumn8details[7]);
G9name = (pmcolumn9details[7]);
G10name = (pmcolumn10details[7]);
G11name = (pmcolumn11details[7]);
G12name = (pmcolumn12details[7]);

	//H Row
H1name = (pmcolumn1details[8]);
H2name = (pmcolumn2details[8]);
H3name = (pmcolumn3details[8]);
H4name = (pmcolumn4details[8]);
H5name = (pmcolumn5details[8]);
H6name = (pmcolumn6details[8]);
H7name = (pmcolumn7details[8]);
H8name = (pmcolumn8details[8]);
H9name = (pmcolumn9details[8]);
H10name = (pmcolumn10details[8]);
H11name = (pmcolumn11details[8]);
H12name = (pmcolumn12details[8]);


//Dilution factors that correspond to 3 samples per plate from materials template
//A Row
df3sampA1name = Num( pmcolumn1details[12] );
df3sampA2name = Num( pmcolumn2details[12] );
df3sampA3name = Num( pmcolumn3details[12] );
df3sampA4name = Num( pmcolumn4details[12] );
df3sampA5name = Num( pmcolumn5details[12] );
df3sampA6name = Num( pmcolumn6details[12] );
df3sampA7name = Num( pmcolumn7details[12] );
df3sampA8name = Num( pmcolumn8details[12] );
df3sampA9name = Num( pmcolumn9details[12] );
df3sampA10name = Num( pmcolumn10details[12] );
df3sampA11name = Num( pmcolumn11details[12] );
df3sampA12name = Num( pmcolumn12details[12] );

	//B Row
df3sampB1name = Num( pmcolumn1details[13] );
df3sampB2name = Num( pmcolumn2details[13] );
df3sampB3name = Num( pmcolumn3details[13] );
df3sampB4name = Num( pmcolumn4details[13] );
df3sampB5name = Num( pmcolumn5details[13] );
df3sampB6name = Num( pmcolumn6details[13] );
df3sampB7name = Num( pmcolumn7details[13] );
df3sampB8name = Num( pmcolumn8details[13] );
df3sampB9name = Num( pmcolumn9details[13] );
df3sampB10name = Num( pmcolumn10details[13] );
df3sampB11name = Num( pmcolumn11details[13] );
df3sampB12name = Num( pmcolumn12details[13] );

	//C Row
df3sampC1name = Num( pmcolumn1details[14] );
df3sampC2name = Num( pmcolumn2details[14] );
df3sampC3name = Num( pmcolumn3details[14] );
df3sampC4name = Num( pmcolumn4details[14] );
df3sampC5name = Num( pmcolumn5details[14] );
df3sampC6name = Num( pmcolumn6details[14] );
df3sampC7name = Num( pmcolumn7details[14] );
df3sampC8name = Num( pmcolumn8details[14] );
df3sampC9name = Num( pmcolumn9details[14] );
df3sampC10name = Num( pmcolumn10details[14] );
df3sampC11name = Num( pmcolumn11details[14] );
df3sampC12name = Num( pmcolumn12details[14] );

	//D Row
df3sampD1name = Num( pmcolumn1details[15] );
df3sampD2name = Num( pmcolumn2details[15] );
df3sampD3name = Num( pmcolumn3details[15] );
df3sampD4name = Num( pmcolumn4details[15] );
df3sampD5name = Num( pmcolumn5details[15] );
df3sampD6name = Num( pmcolumn6details[15] );
df3sampD7name = Num( pmcolumn7details[15] );
df3sampD8name = Num( pmcolumn8details[15] );
df3sampD9name = Num( pmcolumn9details[15] );
df3sampD10name = Num( pmcolumn10details[15] );
df3sampD11name = Num( pmcolumn11details[15] );
df3sampD12name = Num( pmcolumn12details[15] );

	//E Row
df3sampE1name = Num( pmcolumn1details[16] );
df3sampE2name = Num( pmcolumn2details[16] );
df3sampE3name = Num( pmcolumn3details[16] );
df3sampE4name = Num( pmcolumn4details[16] );
df3sampE5name = Num( pmcolumn5details[16] );
df3sampE6name = Num( pmcolumn6details[16] );
df3sampE7name = Num( pmcolumn7details[16] );
df3sampE8name = Num( pmcolumn8details[16] );
df3sampE9name = Num( pmcolumn9details[16] );
df3sampE10name = Num( pmcolumn10details[16] );
df3sampE11name = Num( pmcolumn11details[16] );
df3sampE12name = Num( pmcolumn12details[16] );

	//F Row
df3sampF1name = Num( pmcolumn1details[17] );
df3sampF2name = Num( pmcolumn2details[17] );
df3sampF3name = Num( pmcolumn3details[17] );
df3sampF4name = Num( pmcolumn4details[17] );
df3sampF5name = Num( pmcolumn5details[17] );
df3sampF6name = Num( pmcolumn6details[17] );
df3sampF7name = Num( pmcolumn7details[17] );
df3sampF8name = Num( pmcolumn8details[17] );
df3sampF9name = Num( pmcolumn9details[17] );
df3sampF10name = Num( pmcolumn10details[17] );
df3sampF11name = Num( pmcolumn11details[17] );
df3sampF12name = Num( pmcolumn12details[17] );

	//G Row
df3sampG1name = Num( pmcolumn1details[18] );
df3sampG2name = Num( pmcolumn2details[18] );
df3sampG3name = Num( pmcolumn3details[18] );
df3sampG4name = Num( pmcolumn4details[18] );
df3sampG5name = Num( pmcolumn5details[18] );
df3sampG6name = Num( pmcolumn6details[18] );
df3sampG7name = Num( pmcolumn7details[18] );
df3sampG8name = Num( pmcolumn8details[18] );
df3sampG9name = Num( pmcolumn9details[18] );
df3sampG10name = Num( pmcolumn10details[18] );
df3sampG11name = Num( pmcolumn11details[18] );
df3sampG12name = Num( pmcolumn12details[18] );

	//H Row
df3sampH1name = Num( pmcolumn1details[19] );
df3sampH2name = Num( pmcolumn2details[19] );
df3sampH3name = Num( pmcolumn3details[19] );
df3sampH4name = Num( pmcolumn4details[19] );
df3sampH5name = Num( pmcolumn5details[19] );
df3sampH6name = Num( pmcolumn6details[19] );
df3sampH7name = Num( pmcolumn7details[19] );
df3sampH8name = Num( pmcolumn8details[19] );
df3sampH9name = Num( pmcolumn9details[19] );
df3sampH10name = Num( pmcolumn10details[19] );
df3sampH11name = Num( pmcolumn11details[19] );
df3sampH12name = Num( pmcolumn12details[19] );


	//Dilution factors that correspond to Medium dilution factor from materials template
	//A Row
	df2sampA1name=num(pmcolumn1details[22]);
	df2sampA2name=num(pmcolumn2details[22]);
	df2sampA3name=num(pmcolumn3details[22]);
	df2sampA4name=num(pmcolumn4details[22]);
	df2sampA5name=num(pmcolumn5details[22]);
	df2sampA6name=num(pmcolumn6details[22]);
	df2sampA7name=num(pmcolumn7details[22]);
	df2sampA8name=num(pmcolumn8details[22]);
	df2sampA9name=num(pmcolumn9details[22]);
	df2sampA10name=num(pmcolumn10details[22]);
	df2sampA11name=num(pmcolumn11details[22]);
	df2sampA12name=num(pmcolumn12details[22]);

	//B Row
	df2sampB1name=num(pmcolumn1details[23]);
	df2sampB2name=num(pmcolumn2details[23]);
	df2sampB3name=num(pmcolumn3details[23]);
	df2sampB4name=num(pmcolumn4details[23]);
	df2sampB5name=num(pmcolumn5details[23]);
	df2sampB6name=num(pmcolumn6details[23]);
	df2sampB7name=num(pmcolumn7details[23]);
	df2sampB8name=num(pmcolumn8details[23]);
	df2sampB9name=num(pmcolumn9details[23]);
	df2sampB10name=num(pmcolumn10details[23]);
	df2sampB11name=num(pmcolumn11details[23]);
	df2sampB12name=num(pmcolumn12details[23]);

	//C Row
	df2sampC1name=num(pmcolumn1details[24]);
	df2sampC2name=num(pmcolumn2details[24]);
	df2sampC3name=num(pmcolumn3details[24]);
	df2sampC4name=num(pmcolumn4details[24]);
	df2sampC5name=num(pmcolumn5details[24]);
	df2sampC6name=num(pmcolumn6details[24]);
	df2sampC7name=num(pmcolumn7details[24]);
	df2sampC8name=num(pmcolumn8details[24]);
	df2sampC9name=num(pmcolumn9details[24]);
	df2sampC10name=num(pmcolumn10details[24]);
	df2sampC11name=num(pmcolumn11details[24]);
	df2sampC12name=num(pmcolumn12details[24]);

	//D Row
	df2sampD1name=num(pmcolumn1details[25]);
	df2sampD2name=num(pmcolumn2details[25]);
	df2sampD3name=num(pmcolumn3details[25]);
	df2sampD4name=num(pmcolumn4details[25]);
	df2sampD5name=num(pmcolumn5details[25]);
	df2sampD6name=num(pmcolumn6details[25]);
	df2sampD7name=num(pmcolumn7details[25]);
	df2sampD8name=num(pmcolumn8details[25]);
	df2sampD9name=num(pmcolumn9details[25]);
	df2sampD10name=num(pmcolumn10details[25]);
	df2sampD11name=num(pmcolumn11details[25]);
	df2sampD12name=num(pmcolumn12details[25]);

	//E Row
	df2sampE1name=num(pmcolumn1details[26]);
	df2sampE2name=num(pmcolumn2details[26]);
	df2sampE3name=num(pmcolumn3details[26]);
	df2sampE4name=num(pmcolumn4details[26]);
	df2sampE5name=num(pmcolumn5details[26]);
	df2sampE6name=num(pmcolumn6details[26]);
	df2sampE7name=num(pmcolumn7details[26]);
	df2sampE8name=num(pmcolumn8details[26]);
	df2sampE9name=num(pmcolumn9details[26]);
	df2sampE10name=num(pmcolumn10details[26]);
	df2sampE11name=num(pmcolumn11details[26]);
	df2sampE12name=num(pmcolumn12details[26]);

	//F Row
	df2sampF1name=num(pmcolumn1details[27]);
	df2sampF2name=num(pmcolumn2details[27]);
	df2sampF3name=num(pmcolumn3details[27]);
	df2sampF4name=num(pmcolumn4details[27]);
	df2sampF5name=num(pmcolumn5details[27]);
	df2sampF6name=num(pmcolumn6details[27]);
	df2sampF7name=num(pmcolumn7details[27]);
	df2sampF8name=num(pmcolumn8details[27]);
	df2sampF9name=num(pmcolumn9details[27]);
	df2sampF10name=num(pmcolumn10details[27]);
	df2sampF11name=num(pmcolumn11details[27]);
	df2sampF12name=num(pmcolumn12details[27]);

	//G Row
	df2sampG1name=num(pmcolumn1details[28]);
	df2sampG2name=num(pmcolumn2details[28]);
	df2sampG3name=num(pmcolumn3details[28]);
	df2sampG4name=num(pmcolumn4details[28]);
	df2sampG5name=num(pmcolumn5details[28]);
	df2sampG6name=num(pmcolumn6details[28]);
	df2sampG7name=num(pmcolumn7details[28]);
	df2sampG8name=num(pmcolumn8details[28]);
	df2sampG9name=num(pmcolumn9details[28]);
	df2sampG10name=num(pmcolumn10details[28]);
	df2sampG11name=num(pmcolumn11details[28]);
	df2sampG12name=num(pmcolumn12details[28]);

	//H Row
	df2sampH1name=num(pmcolumn1details[29]);
	df2sampH2name=num(pmcolumn2details[29]);
	df2sampH3name=num(pmcolumn3details[29]);
	df2sampH4name=num(pmcolumn4details[29]);
	df2sampH5name=num(pmcolumn5details[29]);
	df2sampH6name=num(pmcolumn6details[29]);
	df2sampH7name=num(pmcolumn7details[29]);
	df2sampH8name=num(pmcolumn8details[29]);
	df2sampH9name=num(pmcolumn9details[29]);
	df2sampH10name=num(pmcolumn10details[29]);
	df2sampH11name=num(pmcolumn11details[29]);
	df2sampH12name=num(pmcolumn12details[29]);

	//Dilution factors that correspond to low dilution factor from materials template
	//A Row
	df1sampA1name=num(pmcolumn1details[32]);
	df1sampA2name=num(pmcolumn2details[32]);
	df1sampA3name=num(pmcolumn3details[32]);
	df1sampA4name=num(pmcolumn4details[32]);
	df1sampA5name=num(pmcolumn5details[32]);
	df1sampA6name=num(pmcolumn6details[32]);
	df1sampA7name=num(pmcolumn7details[32]);
	df1sampA8name=num(pmcolumn8details[32]);
	df1sampA9name=num(pmcolumn9details[32]);
	df1sampA10name=num(pmcolumn10details[32]);
	df1sampA11name=num(pmcolumn11details[32]);
	df1sampA12name=num(pmcolumn12details[32]);

	//B Row
	df1sampB1name=num(pmcolumn1details[33]);
	df1sampB2name=num(pmcolumn2details[33]);
	df1sampB3name=num(pmcolumn3details[33]);
	df1sampB4name=num(pmcolumn4details[33]);
	df1sampB5name=num(pmcolumn5details[33]);
	df1sampB6name=num(pmcolumn6details[33]);
	df1sampB7name=num(pmcolumn7details[33]);
	df1sampB8name=num(pmcolumn8details[33]);
	df1sampB9name=num(pmcolumn9details[33]);
	df1sampB10name=num(pmcolumn10details[33]);
	df1sampB11name=num(pmcolumn11details[33]);
	df1sampB12name=num(pmcolumn12details[33]);

	//C Row
	df1sampC1name=num(pmcolumn1details[34]);
	df1sampC2name=num(pmcolumn2details[34]);
	df1sampC3name=num(pmcolumn3details[34]);
	df1sampC4name=num(pmcolumn4details[34]);
	df1sampC5name=num(pmcolumn5details[34]);
	df1sampC6name=num(pmcolumn6details[34]);
	df1sampC7name=num(pmcolumn7details[34]);
	df1sampC8name=num(pmcolumn8details[34]);
	df1sampC9name=num(pmcolumn9details[34]);
	df1sampC10name=num(pmcolumn10details[34]);
	df1sampC11name=num(pmcolumn11details[34]);
	df1sampC12name=num(pmcolumn12details[34]);

	//D Row
	df1sampD1name=num(pmcolumn1details[35]);
	df1sampD2name=num(pmcolumn2details[35]);
	df1sampD3name=num(pmcolumn3details[35]);
	df1sampD4name=num(pmcolumn4details[35]);
	df1sampD5name=num(pmcolumn5details[35]);
	df1sampD6name=num(pmcolumn6details[35]);
	df1sampD7name=num(pmcolumn7details[35]);
	df1sampD8name=num(pmcolumn8details[35]);
	df1sampD9name=num(pmcolumn9details[35]);
	df1sampD10name=num(pmcolumn10details[35]);
	df1sampD11name=num(pmcolumn11details[35]);
	df1sampD12name=num(pmcolumn12details[35]);

	//E Row
	df1sampE1name=num(pmcolumn1details[36]);
	df1sampE2name=num(pmcolumn2details[36]);
	df1sampE3name=num(pmcolumn3details[36]);
	df1sampE4name=num(pmcolumn4details[36]);
	df1sampE5name=num(pmcolumn5details[36]);
	df1sampE6name=num(pmcolumn6details[36]);
	df1sampE7name=num(pmcolumn7details[36]);
	df1sampE8name=num(pmcolumn8details[36]);
	df1sampE9name=num(pmcolumn9details[36]);
	df1sampE10name=num(pmcolumn10details[36]);
	df1sampE11name=num(pmcolumn11details[36]);
	df1sampE12name=num(pmcolumn12details[36]);

	//F Row
	df1sampF1name=num(pmcolumn1details[37]);
	df1sampF2name=num(pmcolumn2details[37]);
	df1sampF3name=num(pmcolumn3details[37]);
	df1sampF4name=num(pmcolumn4details[37]);
	df1sampF5name=num(pmcolumn5details[37]);
	df1sampF6name=num(pmcolumn6details[37]);
	df1sampF7name=num(pmcolumn7details[37]);
	df1sampF8name=num(pmcolumn8details[37]);
	df1sampF9name=num(pmcolumn9details[37]);
	df1sampF10name=num(pmcolumn10details[37]);
	df1sampF11name=num(pmcolumn11details[37]);
	df1sampF12name=num(pmcolumn12details[37]);

	//G Row
	df1sampG1name=num(pmcolumn1details[38]);
	df1sampG2name=num(pmcolumn2details[38]);
	df1sampG3name=num(pmcolumn3details[38]);
	df1sampG4name=num(pmcolumn4details[38]);
	df1sampG5name=num(pmcolumn5details[38]);
	df1sampG6name=num(pmcolumn6details[38]);
	df1sampG7name=num(pmcolumn7details[38]);
	df1sampG8name=num(pmcolumn8details[38]);
	df1sampG9name=num(pmcolumn9details[38]);
	df1sampG10name=num(pmcolumn10details[38]);
	df1sampG11name=num(pmcolumn11details[38]);
	df1sampG12name=num(pmcolumn12details[38]);

	//H Row
	df1sampH1name=num(pmcolumn1details[39]);
	df1sampH2name=num(pmcolumn2details[39]);
	df1sampH3name=num(pmcolumn3details[39]);
	df1sampH4name=num(pmcolumn4details[39]);
	df1sampH5name=num(pmcolumn5details[39]);
	df1sampH6name=num(pmcolumn6details[39]);
	df1sampH7name=num(pmcolumn7details[39]);
	df1sampH8name=num(pmcolumn8details[39]);
	df1sampH9name=num(pmcolumn9details[39]);
	df1sampH10name=num(pmcolumn10details[39]);
	df1sampH11name=num(pmcolumn11details[39]);
	df1sampH12name=num(pmcolumn12details[39]);
	
	
//4 MOI concentration
A1con=column1details[31];
B1con=column1details[32];
C1con=column1details[33];
D1con=column1details[34];

//close first tab
close(dtconfig, no save);

	//Open data table for materials
	dtAssayInfo =current data table();
	
	//save names and values for the assay 
	AssayDetailsNames = Column(dtAssayInfo,2)[1::13];
	AssayDetailsValues = Column(dtAssayInfo,3)[1::13];
	
	
	assaynameval=AssayDetailsValues[1];
	
	//instrument id
	instrumentid=column(dtAssayInfo,3)[9];
	
	//Reference Standard Lot#
	refstandlotnumber = column(dtAssayInfo,4)[25];
	
	//Reference Name
	referencename = column(dtAssayInfo,2)[25];
	
	//Cell Concentration
	cellconcentationvalue=column(dtAssayInfo,4)[27];
	
	//Bioassay preparation date and operator
	bioassayprep=column(dtAssayInfo,3)[11];
			assaydate=char(AssayDetailsValues[3]);
		purposevalue=AssayDetailsValues[4];
		bioassayrun=AssayDetailsValues[5];
		analystname = AssayDetailsValues[6];
		bioassayprep = AssayDetailsValues[11];
		bioassayrev = AssayDetailsValues[12];
		signalvalue=AssayDetailsValues[7];
		methodvalue= AssayDetailsValues[8];
		assaynotes =  AssayDetailsValues[13];

	
		//materials and equipment for tracking and trending
			Material_1 = Column(dtAssayInfo, 2)[15];
		Source_1 = Column(dtAssayInfo, 3)[15];
		Catalog_1 = Column(dtAssayInfo, 4)[15];
		Lot_1 = Column(dtAssayInfo, 5)[15];
		Expiration_1 = Column(dtAssayInfo, 6)[15];
		Material_2 = Column(dtAssayInfo, 2)[16];
		Source_2 = Column(dtAssayInfo, 3)[16];
		Catalog_2 = Column(dtAssayInfo, 4)[16];
		Lot_2 = Column(dtAssayInfo, 5)[16];
		Expiration_2 = Column(dtAssayInfo, 6)[16];
		Material_3 = Column(dtAssayInfo, 2)[17];
		Source_3 = Column(dtAssayInfo, 3)[17];
		Catalog_3 = Column(dtAssayInfo, 4)[17];
		Lot_3 = Column(dtAssayInfo, 5)[17];
		Expiration_3 = Column(dtAssayInfo, 6)[17];
		Material_4 = Column(dtAssayInfo, 2)[18];
		Source_4 = Column(dtAssayInfo, 3)[18];
		Catalog_4 = Column(dtAssayInfo, 4)[18];
		Lot_4 = Column(dtAssayInfo, 5)[18];
		Expiration_4 = Column(dtAssayInfo, 6)[18];
		Material_5 = Column(dtAssayInfo, 2)[19];
		Source_5 = Column(dtAssayInfo, 3)[19];
		Catalog_5 = Column(dtAssayInfo, 4)[19];
		Lot_5 = Column(dtAssayInfo, 5)[19];
		Expiration_5 = Column(dtAssayInfo, 6)[19];
		Material_6 = Column(dtAssayInfo, 2)[20];
		Source_6 = Column(dtAssayInfo, 3)[20];
		Catalog_6 = Column(dtAssayInfo, 4)[20];
		Lot_6 = Column(dtAssayInfo, 5)[20];
		Expiration_6 = Column(dtAssayInfo, 6)[20];
		Material_7 = Column(dtAssayInfo, 2)[21];
		Source_7 = Column(dtAssayInfo, 3)[21];
		Catalog_7 = Column(dtAssayInfo, 4)[21];
		Lot_7 = Column(dtAssayInfo, 5)[21];
		Expiration_7 = Column(dtAssayInfo, 6)[21];
		Material_8 = Column(dtAssayInfo, 2)[22];
		Source_8 = Column(dtAssayInfo, 3)[22];
		Catalog_8 = Column(dtAssayInfo, 4)[22];
		Lot_8 = Column(dtAssayInfo, 5)[22];
		Expiration_8 = Column(dtAssayInfo, 6)[22];
		RSDescriptionvalue = Column(dtAssayInfo, 3)[25];
		RSExpiryvalue = Column(dtAssayInfo, 5)[25];
		StabilityCF = num(Column(dtAssayInfo, 7)[25]);
		ReferenceLotCF=num(Column(dtAssayInfo, 6)[25]);

//close the materials template
close(dtAssayInfo, no save);


//GUI for selecting data file from QuantaSoft 
datafilenamerlist = Pick File( "Select Assay Run Plate Files", "", {"All Files|*"}, 1, 0, "Plate Files.jmp", multiple );	


platenumber = N Items( datafilenamerlist );

if (
platenumber == 1,  

positionA = Contains( datafilenamerlist[1] , "/" , -1); //finds first position for file name
platenameA =  Substr( datafilenamerlist[1], positionA+1 );//subtracts folder path from file name

positionC = Contains( platenameA , "." );//finds last position for file name

platenamerA =Substr( platenameA, 1, positionC - 1 );//final template file name
,
platenumber == 2, 

positionA = Contains( datafilenamerlist[1] , "/" , -1); //finds first position for file name
positionB = Contains( datafilenamerlist[2] , "/" , -1); //finds first position for file name
platenameA =  Substr( datafilenamerlist[1], positionA+1 );//subtracts folder path from file name
platenameB =  Substr( datafilenamerlist[2], positionB+1 );//subtracts folder path from file name

positionC = Contains( platenameA , "." );//finds last position for file name
positionD = Contains( platenameB , "." );//finds last position for file name

platenamerA =Substr( platenameA, 1, positionC - 1 );//final template file name
platenamerB = Substr( platenameB, 1, positionD - 1 );//final template file name
,
platenumber == 3,  

positionA = Contains( datafilenamerlist[1] , "/" , -1); //finds first position for file name
positionB = Contains( datafilenamerlist[2] , "/" , -1); //finds first position for file name
positionC = Contains( datafilenamerlist[2] , "/" , -1); //finds first position for file name
platenameA =  Substr( datafilenamerlist[1], positionA+1 );//subtracts folder path from file name
platenameB =  Substr( datafilenamerlist[2], positionB+1 );//subtracts folder path from file name
platenameC =  Substr( datafilenamerlist[2], positionB+1 );//subtracts folder path from file name

positionD = Contains( platenameA , "." );//finds last position for file name
positionE = Contains( platenameB , "." );//finds last position for file name
positionF = Contains( platenameC , "." );//finds last position for file name

platenamerA =Substr( platenameA, 1, positionC - 1 );//final template file name
platenamerB = Substr( platenameB, 1, positionD - 1 );//final template file name
platenamerC = Substr( platenameB, 1, positionD - 1 );//final template file name
);

// Loading user selected files
dtname = List( platenumber  );

	LineBox = expr(Text Box("__________________________________________________________________________________________________________________________________________________________________________________________________", << set wrap(2000)) << journal());
	DashedLine = expr(Text Box("- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - ", << set wrap(2000)) << journal());
	VSpacer = function({ n },{Default Local},
		String = "Text  Box( \!"";
		for(i=1, i<=n,i++,
			concat to(string,"\!n")
		);
		concat to(string,"\!") << journal();");
		eval(parse(string));
	);


//
For( i = 1, i < platenumber + 1, i++,
	dt = Open(datafilenamerlist[i] );
	dtname[i] = dt << get name;
);

//Load user selected files depending on the number of pcr plates

//1 pcr plate
If(platenumber==1,
	data table(dtname[1])<<New Column( "Infection Plate",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	formula(
		1
	)
);

dttext = Data Table( dtname[1] );
);

//2 pcr plates
If( platenumber  == 2,
current data table(data table(dtname[1]));
	data table(dtname[1])<<New Column( "Infection Plate",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	formula(
		1
	)
);
current data table(data table(dtname[2]));
	data table(dtname[2])<<New Column( "Infection Plate",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	formula(
		2
	)
);
current data table(Data Table( dtname[1] ) );
	dttext = Data Table( dtname[1] ) << Concatenate( Data Table( dtname[2] ) );
	Close( dtname[1], no save );
	Close( dtname[2], no save );
			
);

//3 pcr plates
If( platenumber == 3,
	data table(dtname[1])<<New Column( "Infection Plate",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	formula(
		1
	)
);
	data table(dtname[2])<<New Column( "Infection Plate",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	formula(
		2
	)
);
	data table(dtname[3])<<New Column( "Infection Plate",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	formula(
		3
	)
);
	dttext = Data Table( dtname[1] ) << Concatenate( Data Table( dtname[2] ), Data Table( dtname[3] ) );
	Close( dtname[1], no save );
	Close( dtname[2], no save );
	Close( dtname[3], no save );
			
);

dttext = Current Data Table();


dttext << delete columns( 2, 3, 5, 6, 7 );
dttext << delete columns( 4 :: 16 );
dttext <<delete columns(5::45);
:Name("AcceptedDroplets")<<set name("Accepted Droplets");


//get the corresponding number of samples based on the number of rows
totalrownumbers=nrows(dttext);

//create dilution factor column
dttext<<New Column( "Dilution Factor",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	Formula(
		If( :Infection Plate == 1,
			Match( :Well,
				"A01", df3sampA1name,
				"A02", df3sampA2name,
				"A03", df3sampA3name,
				"A04", df3sampA4name,
				"A05", df3sampA5name,
				"A06", df3sampA6name,
				"A07", df3sampA7name,
				"A08", df3sampA8name,
				"A09", df3sampA9name,
				"A10", df3sampA10name,
				"A11", df3sampA11name,
				"A12", df3sampA12name,			
				"B01", df3sampB1name,
				"B02", df3sampB2name,
				"B03", df3sampB3name,
				"B04", df3sampB4name,
				"B05", df3sampB5name,
				"B06", df3sampB6name,
				"B07", df3sampB7name,
				"B08", df3sampB8name,
				"B09", df3sampB9name,
				"B10", df3sampB10name,
				"B11", df3sampB11name,
				"B12", df3sampB12name,				
				"C01", df3sampC1name,
				"C02", df3sampC2name,
				"C03", df3sampC3name,
				"C04", df3sampC4name,
				"C05", df3sampC5name,
				"C06", df3sampC6name,
				"C07", df3sampC7name,
				"C08", df3sampC8name,
				"C09", df3sampC9name,
				"C10", df3sampC10name,
				"C11", df3sampC11name,
				"C12", df3sampC12name,
				"D01", df3sampD1name,
				"D02", df3sampD2name,
				"D03", df3sampD3name,
				"D04", df3sampD4name,
				"D05", df3sampD5name,
				"D06", df3sampD6name,
				"D07", df3sampD7name,
				"D08", df3sampD8name,
				"D09", df3sampD9name,
				"D10", df3sampD10name,
				"D11", df3sampD11name,
				"D12", df3sampD12name,
				"E01", df3sampE1name,
				"E02", df3sampE2name,
				"E03", df3sampE3name,
				"E04", df3sampE4name,
				"E05", df3sampE5name,
				"E06", df3sampE6name,
				"E07", df3sampE7name,
				"E08", df3sampE8name,
				"E09", df3sampE9name,
				"E10", df3sampE10name,
				"E11", df3sampE11name,
				"E12", df3sampE12name,
				"F01", df3sampF1name,
				"F02", df3sampF2name,
				"F03", df3sampF3name,
				"F04", df3sampF4name,
				"F05", df3sampF5name,
				"F06", df3sampF6name,
				"F07", df3sampF7name,
				"F08", df3sampF8name,
				"F09", df3sampF9name,
				"F10", df3sampF10name,
				"F11", df3sampF11name,
				"F12", df3sampF12name,
				"G01", df3sampG1name,
				"G02", df3sampG2name,
				"G03", df3sampG3name,
				"G04", df3sampG4name,
				"G05", df3sampG5name,
				"G06", df3sampG6name,
				"G07", df3sampG7name,
				"G08", df3sampG8name,
				"G09", df3sampG9name,
				"G10", df3sampG10name,
				"G11", df3sampG11name,
				"G12", df3sampG12name,
				"H01", df3sampH1name,
				"H02", df3sampH2name,
				"H03", df3sampH3name,
				"H04", df3sampH4name,
				"H05", df3sampH5name,
				"H06", df3sampH6name,
				"H07", df3sampH7name,
				"H08", df3sampH8name,
				"H09", df3sampH9name,
				"H10", df3sampH10name,
				"H11", df3sampH11name,
				"H12", df3sampH12name,
				
				Empty(), Empty()
			),
			If( :Infection Plate == 2,
				Match( :Well,
					"A01", df2sampA1name,
					"A02", df2sampA2name,
					"A03", df2sampA3name,
					"A04", df2sampA4name,
					"A05", df2sampA5name,
					"A06", df2sampA6name,
					"A07", df2sampA7name,
					"A08", df2sampA8name,
					"A09", df2sampA9name,
					"A10", df2sampA10name,
					"A11", df2sampA11name,
					"A12", df2sampA12name,					
					"B01", df2sampB1name,
					"B02", df2sampB2name,
					"B03", df2sampB3name,
					"B04", df2sampB4name,
					"B05", df2sampB5name,
					"B06", df2sampB6name,
					"B07", df2sampB7name,
					"B08", df2sampB8name,
					"B09", df2sampB9name,
					"B10", df2sampB10name,
					"B11", df2sampB11name,
					"B12", df2sampB12name,					
					"C01", df2sampC1name,
					"C02", df2sampC2name,
					"C03", df2sampC3name,
					"C04", df2sampC4name,
					"C05", df2sampC5name,
					"C06", df2sampC6name,
					"C07", df2sampC7name,
					"C08", df2sampC8name,
					"C09", df2sampC9name,
					"C10", df2sampC10name,
					"C11", df2sampC11name,
					"C12", df2sampC12name,
					"D01", df2sampD1name,
					"D02", df2sampD2name,
					"D03", df2sampD3name,
					"D04", df2sampD4name,
					"D05", df2sampD5name,
					"D06", df2sampD6name,
					"D07", df2sampD7name,
					"D08", df2sampD8name,
					"D09", df2sampD9name,
					"D10", df2sampD10name,
					"D11", df2sampD11name,
					"D12", df2sampD12name,
					"E01", df2sampE1name,
					"E02", df2sampE2name,
					"E03", df2sampE3name,
					"E04", df2sampE4name,
					"E05", df2sampE5name,
					"E06", df2sampE6name,
					"E07", df2sampE7name,
					"E08", df2sampE8name,
					"E09", df2sampE9name,
					"E10", df2sampE10name,
					"E11", df2sampE11name,
					"E12", df2sampE12name,
					"F01", df2sampF1name,
					"F02", df2sampF2name,
					"F03", df2sampF3name,
					"F04", df2sampF4name,
					"F05", df2sampF5name,
					"F06", df2sampF6name,
					"F07", df2sampF7name,
					"F08", df2sampF8name,
					"F09", df2sampF9name,
					"F10", df2sampF10name,
					"F11", df2sampF11name,
					"F12", df2sampF12name,
					"G01", df2sampG1name,
					"G02", df2sampG2name,
					"G03", df2sampG3name,
					"G04", df2sampG4name,
					"G05", df2sampG5name,
					"G06", df2sampG6name,
					"G07", df2sampG7name,
					"G08", df2sampG8name,
					"G09", df2sampG9name,
					"G10", df2sampG10name,
					"G11", df2sampG11name,
					"G12", df2sampG12name,
					"H01", df2sampH1name,
					"H02", df2sampH2name,
					"H03", df2sampH3name,
					"H04", df2sampH4name,
					"H05", df2sampH5name,
					"H06", df2sampH6name,
					"H07", df2sampH7name,
					"H08", df2sampH8name,
					"H09", df2sampH9name,
					"H10", df2sampH10name,
					"H11", df2sampH11name,
					"H12", df2sampH12name,
					Empty(), Empty()
				),
			
			)
		)
	)
);




//Delete the values that don't correspond to concentration values
current data table(dttext);

//
dttext<<New Column( "Sampling",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	Formula(
			Match( :Well,
				"A01", A1name,
				"A02", A2name,
				"A03", A3name,
				"A04", A4name,
				"A05", A5name,
				"A06", A6name,
				"A07", A7name,
				"A08", A8name,
				"A09", A9name,
				"A10", A10name,
				"A11", A11name,
				"A12", A12name,			
				"B01", B1name,
				"B02", B2name,
				"B03", B3name,
				"B04", B4name,
				"B05", B5name,
				"B06", B6name,
				"B07", B7name,
				"B08", B8name,
				"B09", B9name,
				"B10", B10name,
				"B11", B11name,
				"B12", B12name,				
				"C01", C1name,
				"C02", C2name,
				"C03", C3name,
				"C04", C4name,
				"C05", C5name,
				"C06", C6name,
				"C07", C7name,
				"C08", C8name,
				"C09", C9name,
				"C10", C10name,
				"C11", C11name,
				"C12", C12name,
				"D01", D1name,
				"D02", D2name,
				"D03", D3name,
				"D04", D4name,
				"D05", D5name,
				"D06", D6name,
				"D07", D7name,
				"D08", D8name,
				"D09", D9name,
				"D10", D10name,
				"D11", D11name,
				"D12", D12name,
				"E01", E1name,
				"E02", E2name,
				"E03", E3name,
				"E04", E4name,
				"E05", E5name,
				"E06", E6name,
				"E07", E7name,
				"E08", E8name,
				"E09", E9name,
				"E10", E10name,
				"E11", E11name,
				"E12", E12name,
				"F01", F1name,
				"F02", F2name,
				"F03", F3name,
				"F04", F4name,
				"F05", F5name,
				"F06", F6name,
				"F07", F7name,
				"F08", F8name,
				"F09", F9name,
				"F10", F10name,
				"F11", F11name,
				"F12", F12name,
				"G01", G1name,
				"G02", G2name,
				"G03", G3name,
				"G04", G4name,
				"G05", G5name,
				"G06", G6name,
				"G07", G7name,
				"G08", G8name,
				"G09", G9name,
				"G10", G10name,
				"G11", G11name,
				"G12", G12name,
				"H01", H1name,
				"H02", H2name,
				"H03", H3name,
				"H04", H4name,
				"H05", H5name,
				"H06", H6name,
				"H07", H7name,
				"H08", H8name,
				"H09", H9name,
				"H10", H10name,
				"H11", H11name,
				"H12", H12name
				)
				)
);

:Sampling<<hide(1);

dttext << select where( Is Missing( :Sampling ) ) << delete rows;


maintablerows=nrows(dttext);

//Sort the Sample column by the infection plate
dttext<< Sort(
			By( :Sampling ),
			Order(  Ascending ), replace);
			
close(dttext, no save);

dttext=current data table();

//Change data type back to character for remaining formulas
:Sample << data type( "Character" );



assayval = 24;

dttext << New Column( "Group",
	Character,
	"Nominal",
	Formula(
		If( Row() <= assayval,
			SN1,
			If( Row() <= assayval * 2,
				SN2,
				If( Row() <= assayval * 3,
					SN3,
					If( Row() <= assayval * 4,
						SN4,
						If(
							Row() <= assayval * 5, 
							SN5,
							
						If(
							 Row() <= assayval * 6,
									SN6,
								If(
							 Row() <= assayval * 7,
									SN7,
									
							empty()

								)
						)
					)
				)
			)
		)
	)
	)
);


//close configuration file
Close( dtconfig, no save );

//Change data type of the concentration column
:Concentration << data type( numeric ) << modeling type( "continuous" );

//Set the final concentrations based on being between 50 and 5000
dttext << New Column( "Final Concentration",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	Formula( If( 50 <= :Concentration < 5000, :Concentration, 0 ) )
);




//Create Copies column
dttext << New Column( "Copies/uL",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	Formula( Num( :Final Concentration ) * 5 )
);

//Create Vg/mL column
dttext << New Column( "Vg/mL",
	Numeric,
	"Continuous",
	Format( "Scientific", 12, 2 ),
	Formula( If( :Name( "Copies/uL" ) != 0, :Name( "Copies/uL" ) * :Dilution Factor * 1000 ) )
);


//Create new data table that has the average Vg/mL values
dttextsum2 = dttext << Summary(
	Group( :Group, :Sampling ),
	Mean( :Name( "Vg/mL" ) ),
	Mean( :Name( "Accepted Droplets" ) ),
	Std Dev( :Name( "Vg/mL" ) ),
	CV( :Name( "Vg/mL" ) ),
	Freq( "None" ),
	Weight( "None" ),
);
		

	//get the numbers for the MOI concentrations needed to calculate nomninaldose
	dilutionnumberlister = list();
	dilutionnumberlister[1]=num(A1con);
	dilutionnumberlister[2]=num(B1con);
	dilutionnumberlister[3]=num(C1con);
	dilutionnumberlister[4]=num(D1con);

//record nominal dose (the middle dose; since there are 4 MOI it is the median) to calculate infectious particle ratio
nominaldose = median(dilutionnumberlister);

//list of concentrations
moilist = List();
moilist[1] = Char( A1con );
moilist[2] = Char( B1con );
moilist[3] = Char( C1con );
moilist[4] = Char( D1con );

//Make MOI Column
current data table(dttextsum2);
dttextsum2 << New Column( "MOI",
	continuous,
	numeric,
	Values( Repeat( moilist, Floor( N Rows( dttextsum2 ) / N Items( moilist ) ) ) )
);

//Change MOI column to Scientific Notation
:MOI << Format( "Scientific", 12 );

//Transform the MOI data using Log 10
dttextsum2 << New Column( "Log10 MOI", continuous, numeric, formula( Log10( :MOI ) ) );


//make log10 of each of the concentrations
moival1 = Log10( num(A1con) );
moival2 = Log10( num(B1con) );
moival3 = Log10( num(C1con) );
moival4 = Log10( num(D1con) );


//Copy the table without formulas
Current Data Table( dttextsum2 );

dttextsum3=dttextsum2<<subset(invisible,Copy formula( 0 ), All rows, Selected columns only( 0 ));


close(dttextsum2, no save);

//Rename the data table to be dttextsum2
dttextsum2=dttextsum3;


//Rename the data table that will be used in analysis
dttextsum2 << set name( filenamer );


// Set up the report window that will be the first page of the pdf report
// this page includes the logos of Bioassay Sciences and astellas
// it also includes user and time log information
// Set up the report window
heading = New Window( "astellas Potency Report",
	V List Box(
		String Col Box( "", {spacer} ),
		H List Box( String Col Box( "", {spacer} ) ),
		H List Box( V List Box( Picture Box( astellaslogo ) ), ),
		H List Box( String Col Box( "", {spacer} ) ),
		H List Box( cb = Text Box( "Astellas KT430 Infectivity Assay Report" ) ),
		H List Box( at = Text Box( "Test Article Report" ) ), 

	),
	V List Box( H List Box( String Col Box( "", {spacer} ) ) ),

	V List Box( H List Box( String Col Box( "", {spacer} ) ) ),
	V List Box(), 

);
cb << Font Color( 19 ) << Set Font Size( 20 ) << set Font Style( "Bold" );
cb << Set Wrap( 1000 );
at << Set Font Size( 20 );
at << Font Color( "Blue" ) << set Font Style( "Bold" );
Heading << journal << close window;

//User Report
userreport = New Window( "User Report",
	V List Box( H List Box( String Col Box( "", {liner} ) ) ),
	V List Box(

		String Col Box( "", {spacer} ), 
	
		H List Box( username = Text Box( "Assay Details" ) ),
		V List Box( H List Box( String Col Box( "", {liner} ) ) ),
		String Col Box( "", {spacer} ),
		String Col Box( "", {spacer} ),
		String Col Box( "User Information",
			{usernamedisplay, computernamedisplay, logonserverdisplay, userdomaindisplay, scriptver,
			Concat( "JMP Version ", jmpreport )}
		),
		String Col Box( "", {spacer} ),
		String Col Box( "", {spacer} ),
		String Col Box( "", {spacer} ), 

	),
	V List Box( H List Box( String Col Box( "", {dashliner, "Analyst Signature/Date"} ) ) ),
	String Col Box( "", {spacer} ),
	String Col Box( "", {spacer} ),
	String Col Box( "", {spacer} ),
	V List Box( H List Box( String Col Box( "", {dashliner, "Approver Signature/Date"} ) ) ), 
);
username << Set Font Size( 16 );
username << Font Color( " Blue" ) << set Font Style( "Bold" );
userreport << journal << close window;

//Page break to go to another page in the report
pagebreaker = New Window( "     Nothing Really",
	V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
);
pagebreaker << journal << close window;


	
		//Materials for first assay run
	materialreport = New Window( "Material Report",
		V List Box( H List Box( String Col Box( "", {liner} ) ) ),
		V List Box(
			String Col Box( "", {spacer} ),
			H List Box( materialname = Text Box( concat(assaynameval,""," Files" )) ),
			V List Box( H List Box( String Col Box( "", {liner} ) ) ), 

		),
		String Col Box( "", {spacer} ), 

	);
	materialname << Set Font Size( 16 );
	materialname << Font Color( "Blue" ) << set Font Style( "Bold" );
	materialreport << journal << close window;

	H List Box(
		Text Box("  "),	String Col Box( "First Data File", {dtname[1]} ),
		Text Box("  "),	String Col Box( "Second Data File", {dtname[2]} ),			
		) << journal();
	VSpacer(2);
	
//Make sure all analysis is done on the summary table
Current Data Table( dttextsum2 );

//change name of response column
:Name( "Mean(Vg/mL)" ) << set name( "Vg/mL" );

//change the name of the accepted droplets column
:Name("Mean(Accepted Droplets)")<<set name("Accepted Droplets");


//Create column for the Droplet comparison to 10000
	dttextsum2 << New Column( "Droplet Result", Character, "Nominal", Formula( If( :Accepted Droplets < 10000, "1", "0" ) ) );
	:Droplet Result << delete formula;
	:Droplet Result << hide( 1 );
	
//exclude the rows that droplet count <10000
dttextsum2 << select where( :Droplet Result == "1") << exclude(1) << Clear Select();

//Count the number of wells that fail accepted droplets limit
	dropletsres = :Droplet Result << get values;
	
	delval = List();
	delval[1] = "";

	For( i = 1, i <= N Items( dropletsres ), i++,
		Remove From( dropletsres, As List( Loc( dropletsres, delval[1] ) ) )
	);

	If( Contains( dropletsres, "1" ), 
	
		delcols = List();
		delcols[1] = "0";

		For( i = 1, i <= N Items( dropletsres ), i++,
			Remove From( dropletsres, As List( Loc( dropletsres, delcols[1] ) ) )
		);
	
		dropletsrescount = N Items( dropletsres );
	
	, 
	
		dropletsrescount = 0;
	
	);

//	Failed Droplet Validity
	If( dropletsrescount <= dropletscountlimit,
		dropletsrescountcrit = "Pass",
		"Fail"
	);


//create column for the log transformation of the Vg/mL column
dttextsum2 << New Column( "Log10 Vg/mL",
	Numeric,
	"Continuous",
	Format( "Best", 12 ),
	Formula( Log10( :Name( "Vg/mL" ) ) )
);

//Outlier Identification
//Outlier Jackknife z Within Group/Dose Outlier Determination
multi = dttextsum2 << Multivariate(
    Y( :"Vg/mL"n ),
    Jackknife Distances( 1 ),
    By( :Group, :"MOI"n )
);
multi << Jackknife Distances( 1, Save Jackknife Distances ) << close window;
Column(dttextsum2, n cols()) << Set name( "Jackknife z" ) << Format( "Fixed", 6, 3 );
dttextsum2 << select where( :Jackknife z > outlierlimitnum) << exclude( 1 ) << ClearSelect;

//summary table for mean 
dttextsum2MeanSummary = dttextsum2 << Summary(
    invisible,
    Group( :Group, :"MOI"n ),
    Mean( :"Vg/mL"n )
);

dttextsum2 << Update(
    With( dttextsum2MeanSummary ),
    Match Columns( :Group = :Group, :"MOI"n = :"MOI"n ),
    Add Columns from Update Table( :"Mean(Vg/mL)"n ),
    Replace Columns in Main Table( None )
);
Close( dttextsum2MeanSummary, no save );
dttextsum2 << New Column( "Residual Vg/mL",
    Numeric,
    "Continuous",
    Format( "Fixed Dec", 12, 3 ),
    Formula( :"Vg/mL"n - :"Mean(Vg/mL)"n )
);


//summary table for SD 
dttextsum2SDSummary = dttextsum2 << Summary(
    invisible,
    Group( :"MOI"n ),
    StdDev( :"Residual Vg/mL"n )
);

dttextsum2 << Update(
    With( dttextsum2SDSummary ),
    Match Columns( :"MOI"n = :"MOI"n ),
    Add Columns from Update Table( :"Std Dev(Residual Vg/mL)"n ),
    Replace Columns in Main Table( None )
);
Close( dttextsum2SDSummary, no save );

Eval(EvalExpr(New Column( "Outlier Within Group",
    Character,
    "Nominal",
    Formula(
        If(
            :Jackknife z > Expr(num(outlierlimitnum)),
                If(:"Mean(Vg/mL)"n - 1.96*:"Std Dev(Residual Vg/mL)"n <= :"Vg/mL"n <= :"Mean(Vg/mL)"n + 1.96*:"Std Dev(Residual Vg/mL)"n,
                    "Within Analytical Error",
                    "Outlier"
                ),
            "Ok"
        )
    ),
    Set Property( "Value Colors", {"Ok" = -15400938, "Within Analytical Error" = -15400938, "Outlier" = -16768477} ),
    Color Cell by Value
)));
	
dttextsum2 << Clear Row States;
dttextsum2 << select where( :Outlier Within Group == "Outlier" ) << Exclude(1) << ClearSelect;
dttextsum2 << select where( :Droplet Result == "1") << exclude;

	//create variable name for the test article type. whether it's TA or TI
	
	dttestart=dttextsum2<<select where(!contains(:Group,"Std"))<<subset(invisible);
	
	testsampletypes=:Group<<get values;
	
	testsamplelist= Associative Array( testsampletypes );
	
	talist=testsamplelist<<get keys;
		
	
	//close the TA data table
	close(dttestart, no save);	


//Outlier Studentized Residuals, Between Group/Dose Outlier Determination
//Between Group Outlier Removal Prior to Model Fitting and Masking Selection
current data table(dttextsum2);
dttextsum2 << Clear Row States;
dttextsum2 << select where( :Outlier Within Group == "Outlier" ) << exclude;
dttextsum2 << select where( :Droplet Result == "1") << exclude;
dttextsum2 << select all rows;
dttextsum2 << invert row selection;


//hide outlier within dose columns
:Name("Mean (Vg/mL)")<<hide(1);
:Name("Residual Vg/mL")<<hide(1);
:Name("Std Dev(Residual Vg/mL)")<<hide(1);

//set name of first table
dttextsum2 << set name("first table");





//EC50 STD  Dose Unconstrained Fixed
dtbetween=dttextsum2<<select where( contains( :Name( "Group" ),rstandard))<<subset(invisible);

:Name( "MOI" ) << set modeling type( "Continuous" );

	group1 = Fit Model(
		Y( :Name("Log10 Vg/mL") ),
		Effects( :Group, :Name( "Log10 MOI" ), :Group* :Name( "Log10 MOI" ) ),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			:Name("Log10 Vg/mL") << {Summary of Fit( 1 ), Analysis of Variance( 1 ), Parameter Estimates( 1 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 1 ), Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ), Box Cox Y Transformation( 0 ), Show VIF( 1 )},
			Effect Summary( 0 )
		)
	); 
	group1r = group1 << report;
	group1r << Externally Studentized Residuals; 
	group1r << close window;

	:Name("Externally Studentized Residuals Log10 Vg/mL") << set Name( "Externally Studentized Residuals" );
	:Externally Studentized Residuals << Format( "Fixed Dec", 7, 3 );
	dtbetween << New Column( "Outlier Between Group",
		Character,
		"Nominal",
		formula( If( Abs( :Externally Studentized Residuals ) >= studoutlierlimitnum, "Outlier", "Ok" ) )
	);

	:Outlier Between Group<<Set Property( "Value Colors", {"Ok" = -15400938, "Outlier" = -16768477} )<<Color Cell by Value;
	

	dtbetween << select where( :Outlier Between Group == "Outlier" ) << exclude;
	dtbetween << clear select;


ec50refuncon = Fit Model(
	Y( :Name( "Log10 Vg/mL" ) ),
	Effects( :Name( "Log10 MOI" ) ),
	Personality( "Standard Least Squares" ),
	Emphasis( "Effect Leverage" ),
	Run(
		Profiler(
			1,
			Confidence Intervals( 1 ),
			Term Value( Name( "Log10 MOI" )(-1.29874, Lock( 0 ), Show( 1 )) )
		),
		:Name( "Log10 Vg/mL" ) << {Summary of Fit( 1 ), Analysis of Variance( 1 ), Parameter Estimates( 1 ),
		Scaled Estimates( 1 ), Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 1 ),
		Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ), Plot Effect Leverage( 1 ),
		Plot Residual by Normal Quantiles( 0 ), Box Cox Y Transformation( 0 ), Show VIF( 1 ),
		Inverse Prediction( Response( fixedRFER ), Term Value( Name( "Log10 MOI" )(.) ) )},
		Effect Summary( 0 )
	),
	SendToReport(
		Dispatch(
			{"Response Log10 Vg/mL", "Inverse Prediction"},
			"2",
			ScaleBox,
			{Min( 3.5 ), Max( 6.5 ), Inc( 0.5 ), Minor Ticks( 0 )}
		)
	)
);

ec50refunconr = ec50refuncon << report;
ec50refvalues = ec50refunconr["Inverse Prediction"][columnbox( 2 )] << getasmatrix;
ec50refunconfourdoselog = ec50refvalues[1];
ec50refunconfourdose = 10 ^ (ec50refunconfourdoselog);
ec50refunconr << close window;

dtbetween << clear row states;
dtbetween << select where( :Droplet Result == "1") << exclude;
dtbetween << select where( :Outlier Within Group == "Outlier" ) << exclude;
dtbetween << select where( :Outlier Between Group == "Outlier" ) << exclude;

//Calculate curve depth 
	dtcurvedepth = dtbetween << Summary(
		Group( :MOI ),
		Mean( :"Vg/mL"n ),
		Freq( "None" ),
		Weight( "None" )
	);
	
	
	//Column for calculating the Reference minimum and maximum
	current data table(dtcurvedepth);
	
	
	//Column for calculating the curve depth
	dtcurvedepth << New Column( "Reference Curve Depth",
			continuous,
			formula( If( Row() == 1, Col Maximum( :"Mean(Vg/mL)"n ) - Col Minimum( :"Mean(Vg/mL)"n ) ) )
		);
		:Reference Curve Depth << Format( "Fixed", 7, 2 );
		refcurvedepth = :Reference Curve Depth[1];
			
	close(dtcurvedepth, no save);
	close(ec50refuncon, no save);
	close(dtbetween, no save);


//Systems Suitability List
ssuitabilitylistupper = List();
ssuitabilitylistlower = List();
ssuitabilitylistupper[1] = EC50refupperlimit;
ssuitabilitylistlower[1] = EC50reflowerlimit;


//Setup
samplesizedose = List();
parallelismsample = List();
parallelismvalidity = List();
linearitysample = List();
linearityvalidity = List();
cvperdose = List();
cvvalidity = List();
rpdelta = List();
doseresponse = List();
ec50lsl = List();
ec50usl = List();
rpdeltavalidity = List();
samplesec50ref = List();
samplesec50test = List();
samplesrp = List();
samplesrpu95 = List();
samplesrpl95 = List();
samplesoos = List();
overallvalidity = List();
criterialist = List();
validlist = List();
CIRangelist=List();
CITolerancelist=List();
unconsamplesec50ref = List();
unconsamplesec50test = List();
unconsamplesrp = List();
unconsamplesrpu95 = List();
unconsamplesrpl95 = List();

//Make each tracking variable a list
EC50refslist = list();
EC50testslist = list();
ConstrainedPotencylist = list();
ConstrainedPotencyU95list = list();
ConstrainedPotencyL95list = list();
FinalReportablelist = list();
Failureresultlist = list();
validitylist = list();

parallellist=list();
linearitylist=list();
dosetestlist=list();
selectedmodellist=list();
RPdeltalist=list();
infectparticlelist=list();
finalparallellist=list();
finallinearitylist=list();


//Get max and min MOI value for masking
Current Data Table( dttextsum2 );
moinumbers = :Log10 MOI << get as matrix;
MaximumDose = Max( moinumbers );
MinimumDose = Min( moinumbers );


	//create list of dilution values for the labels on the graphs
	//get a subset of the dilutions
	current data table(dttextsum2);
	dtdilution=dttextsum2<<select where(:MOI !=0)<<subset(invisible);
	:MOI<<modeling type("Nominal")<<data type("Character");
	current data table(dtdilution);
	dilutionlist1=:MOI<<get as matrix;
	dilutionlist= Associative Array( dilutionlist1 );
	dilutionlister = dilutionlist<< Get Keys;
	
	close(dtdilution, no save);

	//make the list of test articles removing the standard based on how many total samples are recorded on the first tab of the materials template
	If( SN1 != "" & SN2 != "" & SN3 != "" & SN4 != "" & SN5 != ""&SN6!=""&SN7!="" , 


	//make the list of the test samples if there are 5 samples and the reference standard
		snames = List();
		snames[1] = SN1;
		snames[2] = SN2;
		snames[3] = SN3;
		snames[4] = SN4;
		snames[5] = SN5;
		snames[6] = SN6;
		snames[7] = SN7;

	//create variables for the final materials list
		samplenames = List();


	//Make the  final list of test articles and standard (if applicable)
		For( i = 1, i <= 7, i++,
			If( Eval( snames[i] ) == "",
				a = 1 + 2,
				samplenames[i] = Eval( snames[i] )
			)
		);


	//Make the final list of test articles excluding the standard group (if applicable)
		delcols = List();
		delcols[1] = rstandard;

		For( i = 1, i <= N Items( samplenames ), i++,
			Remove From( samplenames, As List( Loc( samplenames, delcols[1] ) ) )
		);

	,
	If( SN1 != "" & SN2 != "" & SN3 != "" & SN4 != "" & SN5 != ""&SN6 != "" , 


	//make the list of the test samples if there are 5 samples and the reference standard
		snames = List();
		snames[1] = SN1;
		snames[2] = SN2;
		snames[3] = SN3;
		snames[4] = SN4;
		snames[5] = SN5;
		snames[6] = SN6;

	//create variables for the final materials list
		samplenames = List();


	//Make the  final list of test articles and standard (if applicable)
		For( i = 1, i <= 6, i++,
			If( Eval( snames[i] ) == "",
				a = 1 + 2,
				samplenames[i] = Eval( snames[i] )
			)
		);


	//Make the final list of test articles excluding the standard group (if applicable)
		delcols = List();
		delcols[1] = rstandard;

		For( i = 1, i <= N Items( samplenames ), i++,
			Remove From( samplenames, As List( Loc( samplenames, delcols[1] ) ) )
		);
	, 

		If( SN1 != "" & SN2 != "" & SN3 != "" & SN4 != "" & SN5 != "" , 

	//make the list of the test samples if there are 4 samples and the reference standard
			snames = List();
			snames[1] = SN1;
			snames[2] = SN2;
			snames[3] = SN3;
			snames[4] = SN4;
			snames[5] = SN5;


	//create variables for the final materials list
			samplenames = List();


	//Make the  final list of test articles and standard (if applicable)
			For( i = 1, i <= 5, i++,
				If( Eval( snames[i] ) == "",
					a = 1 + 2,
					samplenames[i] = Eval( snames[i] )
				)
			);


	//Make the final list of test articles excluding the standard group (if applicable)
			delcols = List();
			delcols[1] = rstandard;

			For( i = 1, i <= N Items( samplenames ), i++,
				Remove From( samplenames, As List( Loc( samplenames, delcols[1] ) ) )
			);
		, 

			If( SN1 != "" & SN2 != "" & SN3 != "" & SN4 != "" & SN5 == "" , 

	//make the list of the test samples if there are 3 samples and the reference standard
				snames = List();
				snames[1] = SN1;
				snames[2] = SN2;
				snames[3] = SN3;
				snames[4] = SN4;


	//create variables for the final materials list
				samplenames = List();


	//Make the  final list of test articles and standard (if applicable)
				For( i = 1, i <= 4, i++,
					If( Eval( snames[i] ) == "",
						a = 1 + 2,
						samplenames[i] = Eval( snames[i] )
					)
				);


	//Make the final list of test articles excluding the standard group (if applicable)
				delcols = List();
				delcols[1] = rstandard;

				For( i = 1, i <= N Items( samplenames ), i++,
					Remove From( samplenames, As List( Loc( samplenames, delcols[1] ) ) )
				);
			, 

				If( SN1 != "" & SN2 != "" & SN3 != "" & SN4 == "" & SN5 == "" , 

	//make the list of the test samples if there are 2 samples and the reference standard
					snames = List();
					snames[1] = SN1;
					snames[2] = SN2;
					snames[3] = SN3;


	//create variables for the final materials list
					samplenames = List();


	//Make the  final list of test articles and standard (if applicable)
					For( i = 1, i <= 3, i++,
						If( Eval( snames[i] ) == "",
							a = 1 + 2,
							samplenames[i] = Eval( snames[i] )
						)
					);


	//Make the final list of test articles excluding the standard group (if applicable)
					delcols = List();
					delcols[1] = rstandard;

					For( i = 1, i <= N Items( samplenames ), i++,
						Remove From( samplenames, As List( Loc( samplenames, delcols[1] ) ) )
					);

				, 

					If( SN1 != "" & SN2 != "" & SN3 == "" & SN4 == "" & SN5 == "" , 

	//make the list of the test samples if there is 1 sample and the reference standard
						snames = List();
						snames[1] = SN1;
						snames[2] = SN2;


	//create variables for the final materials list
						samplenames = List();


	//Make the  final list of test articles and standard (if applicable)
						For( i = 1, i <= 2, i++,
							If( Eval( snames[i] ) == "",
								a = 1 + 2,
								samplenames[i] = Eval( snames[i] )
							)
						);


	//Make the final list of test articles excluding the standard group (if applicable)
						delcols = List();
						delcols[1] = rstandard;

						For( i = 1, i <= N Items( samplenames ), i++,
							Remove From( samplenames, As List( Loc( samplenames, delcols[1] ) ) )
						);

					, 

						Empty();
						
						)

					)
				)
			)
		)
	);
	 
 //Record the number of samples for the loop
samplenum = N Items( samplenames );

//Begin For loop for each sample
For( j = 1, j <= samplenum, j++, 

//Determine Max Min Values for the Y axis for Graphs
	dtsubset = dttextsum2 << select where( :Group == rstandard | :Group == samplenames[j] ) << subset( invisible );
	
	//exclude the droplets from the subset data
	ExcludeDroplets= expr((dtsubset << select where( :Droplet Result == "1") << exclude(1)) << Clear Select());
	
	//Between Outliers
		group2 = Fit Model(
		Y( :Name("Log10 Vg/mL") ),
		Effects( :Group, :Name( "Log10 MOI" ), :Group* :Name( "Log10 MOI" ) ),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			:Name("Log10 Vg/mL") << {Summary of Fit( 1 ), Analysis of Variance( 1 ), Parameter Estimates( 1 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 1 ), Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ), Box Cox Y Transformation( 0 ), Show VIF( 1 )},
			Effect Summary( 0 )
		)
	); 
	group2r = group2 << report;
	group2r << Externally Studentized Residuals; 
	group2r << close window;

	:Name("Externally Studentized Residuals Log10 Vg/mL") << set Name( "Externally Studentized Residuals" );
	:Externally Studentized Residuals << Format( "Fixed Dec", 7, 3 );
	
	dtsubset << New Column( "Outlier Between Group",
		Character,
		"Nominal",
		formula( If( Abs( :Externally Studentized Residuals ) >= studoutlierlimitnum, "Outlier", "Ok" ) )
	);

	:Outlier Between Group<<Set Property( "Value Colors", {"Ok" = -15400938, "Outlier" = -16768477} )<<Color Cell by Value;

	dtsubset << select where( :Outlier Between Group == "Outlier" ) << exclude;
	dtsubset << clear select;

	
//Show the Reference Standard data in the report

	refstanddata = New Window( "     Data Display",
		V List Box(
			H List Box( String Col Box( "", {liner} ) ),
			String Col Box( "", {spacer} ),
			H List Box(
				refdataname = Text Box( Concat( samplenames[j]," ","& Reference Standard Data" ) ), 
					//String Col Box("", {spacer}),
			)
		),
		V List Box( H List Box( String Col Box( "", {liner} ) ) ), 

	);
	refdataname << Set Font Size( 16 );
	refdataname << Font Color( " Blue" ) << set Font Style( "Bold" ) << set wrap( 2000 );
	refstanddata << journal << close window;
	dtsubset << Journal; 

	//Add Limits of Outlier Detections to report below table
	jackztb = Text Box( Concat( "Within Group Jackknife z Outlier Limit (≥): ", Char( outlierlimitnum ) ) );
	jackztb << Font Color( " Blue" ) << set Font Style( "Bold" );
	jackztb << Set Font Size( 12 );
	jackztb << Set Wrap( 1000 );
	jackztb << journal;

	studrtb = Text Box( Concat( "Between Group Externally Studentized Residuals Outlier Limit (≥): ", Char( studoutlierlimitnum ) ) );
	studrtb << Font Color( " Blue" ) << set Font Style( "Bold" );
	studrtb << Set Font Size( 12 );
	studrtb << Set Wrap( 1000 );
	studrtb << journal;

	//Add Limits AcceptedDroplets to report below table
		accdroptb = Text Box( "Accepted Droplets: Invalid wells with < 10,000 accepted droplets excluded from all calculations" );
		accdroptb << Font Color( "Blue"  ) << set Font Style( "Bold" );
		accdroptb << Set Font Size( 12 );
		accdroptb << Set Wrap( 1000 );
		accdroptb << journal;

	

	//Summary Statistics header
	summaryreport = New Window( "Plate Map Report",
		V List Box( H List Box( String Col Box( "", {liner} ) ) ),
		V List Box(
			String Col Box( "", {spacer} ),
			H List Box( summaryname = Text Box( concat(samplenames[j]," "," Test Sample & Reference Standard","  Summary Statistics" ) )),
			V List Box( H List Box( String Col Box( "", {liner} ) ) ), 

		),
		String Col Box( "", {spacer} ), 

	);
	summaryname << Set Font Size( 16 );
	summaryname << Font Color( "Blue" ) << set Font Style( "Bold" )<<set wrap(1000);
	summaryreport << journal << close window;

	
	
	dtsubset<<clear select;
		
	
	dtsummary = dtsubset<< Summary(invisible,
		Group( :Group, :Name("MOI") ),
		Mean( :Name("Vg/mL") ),
		Std Dev( :Name("Vg/mL") ),
		Freq( "None" ),
		Weight( "None" )
	);
	dtsummary << delete rows();
	Column( "Mean(Vg/mL)" ) << Format( "Fixed Dec", 7, 3 );
	Column( "Std Dev(Vg/mL)" ) << Format( "Fixed Dec", 7, 3 );
	dtsummary << select where(contains( :Name( "Group" ),"Std"));
	dtsummary << move rows( atstart )<<clear select;
	

	dtsummary<< clear row states;
	dtsummary << journal;
	Close( dtsummary, no save );

//exclude outliers expression
	current data table(dtsubset);
		ExcludeOutliers = expr((dtsubset << select where( :Outlier Between Group == "Outlier"| :Outlier Within Group == "Outlier") << exclude(1)) << Clear Select());
		
	//Best Linear Model Selection that meets all Validity Criteria
	//1)	All data
	//2)	Both low doses excluded
	//3)	Both high doses excluded
	//4)	STD low dose excluded
	//5)	STD high dose excluded
	//6)	Test low dose excluded
	//7)	Test high dose excluded
	//8)	STD low dose and test high dose excluded
	//9)	STD high dose and test low dose excluded

	//Model 1)All data
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select all rows;
	dtsubset << invert row selection;
	
	
	model1 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model1r = model1 << report;
	model1rootmean = model1r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model1rsquare = model1r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model1r2 = model1rsquare[1];
	model1rmse = model1rootmean[1];
	
	//slope ratio value
	model1ratio = model1r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model1sloperatio = model1ratio[2];
	
	//slope ratio lower limit 
	model1ratiolower = model1r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model1sloperatiolower = model1ratiolower[2];

	//slope ratio upper limit 
	model1ratioupper = model1r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model1sloperatioupper = model1ratioupper[2];
	
	
	model1r << close window;


		//model 1 quad and linearity ratio
		model1 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group( "Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model1r = model1 << report;
		model1quadss = model1r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model1conc = model1quadss[4];
		model1quad = model1quadss[7];
		model1quadp = abs(( model1quad * 1 ) / (model1conc * 2))* 100;//Linearity Ratio Formula
		model1r << close window;


	
	//Model 2 Both Low Doses Excluded
	current data table(dtsubset);
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where( :Name( "Log10 MOI" ) == MinimumDose) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;
	
	model2 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model2r = model2 << report;
	model2rootmean = model2r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model2rsquare = model2r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model2r2 = model2rsquare[1];
	model2rmse = model2rootmean[1];
	
	//slope ratio value
	model2ratio = model2r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model2sloperatio = model2ratio[2];
	
	//slope ratio lower limit 
	model2ratiolower = model2r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model2sloperatiolower = model2ratiolower[2];

	//slope ratio upper limit 
	model2ratioupper = model2r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model2sloperatioupper = model2ratioupper[2];
	
	
	model2r << close window;


		//model 2 quad and linearity ratio
		model2 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group( "Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model2r = model2 << report;
		model2quadss = model2r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model2conc = model2quadss[4];
		model2quad = model2quadss[7];
		model2quadp = abs(( model2quad * 1 ) / (model2conc * 2))* 100;//Linearity Ratio Formula
		model2r << close window;


	//Model 3 Both High Doses Excluded
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where( :Name( "Log10 MOI" ) == MaximumDose) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	model3 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model3r = model3 << report;
	model3rootmean = model3r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model3rsquare = model3r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model3r2 = model3rsquare[1];
	model3rmse = model3rootmean[1];

	//slope ratio value
	model3ratio = model3r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model3sloperatio = model3ratio[2];
	
	//slope ratio lower limit 
	model3ratiolower = model3r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model3sloperatiolower = model3ratiolower[2];

	//slope ratio upper limit 
	model3ratioupper = model3r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model3sloperatioupper = model3ratioupper[2];
	
	model3r << close window;
	
		//model 3 quad and linearity ratio
		model3 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group( "Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model3r = model3 << report;
		model3quadss = model3r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model3conc = model3quadss[4];
		model3quad = model3quadss[7];
		model3quadp = abs(( model3quad * 1 ) / (model3conc * 2))* 100;//Linearity Ratio Formula
		model3r << close window;


	//Model 4)	STD Low Dose Excluded
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where( Contains(:Name("Group"),"Std")& :Name( "Log10 MOI" ) == MinimumDose ) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	model4 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model4r = model4 << report;
	model4rootmean = model4r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model4rsquare = model4r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model4r2 = model4rsquare[1];
	model4rmse = model4rootmean[1];

	//slope ratio value
	model4ratio = model4r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model4sloperatio = model4ratio[2];
	
	//slope ratio lower limit 
	model4ratiolower = model4r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model4sloperatiolower = model4ratiolower[2];

	//slope ratio upper limit 
	model4ratioupper = model4r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model4sloperatioupper = model4ratioupper[2];
	
	model4r << close window;

		//model 4 quad and linearity ratio
		model4 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group("Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model4r = model4 << report;
		model4quadss = model4r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model4conc = model4quadss[4];
		model4quad = model4quadss[7];
		model4quadp = abs(( model4quad * 1 ) / (model4conc * 2))* 100;//Linearity Ratio Formula
		model4r << close window;


	//Model 5) STD High Dose Excluded
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where( Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MaximumDose ) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	model5 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model5r = model5 << report;
	model5rootmean = model5r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model5rsquare = model5r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model5r2 = model5rsquare[1];
	model5rmse = model5rootmean[1];

	//slope ratio value
	model5ratio = model5r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model5sloperatio = model5ratio[2];
	
	//slope ratio lower limit 
	model5ratiolower = model5r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model5sloperatiolower = model5ratiolower[2];

	//slope ratio upper limit 
	model5ratioupper = model5r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model5sloperatioupper = model5ratioupper[2];
	
	model5r << close window;
	
		//model 5 quad and linearity ratio
		model5 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group( "Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model5r = model5 << report;
		model5quadss = model5r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model5conc = model5quadss[4];
		model5quad = model5quadss[7];
		model5quadp =abs(( model5quad * 1 ) / (model5conc * 2))* 100;//Linearity Ratio Formula
		model5r << close window;


	//Model 6) Test Low Dose Excluded
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where(!Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MinimumDose ) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	model6 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model6r = model6 << report;
	model6rootmean = model6r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model6rsquare = model6r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model6r2 = model6rsquare[1];
	model6rmse = model6rootmean[1];

	//slope ratio value
	model6ratio = model6r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model6sloperatio = model6ratio[2];
	
	//slope ratio lower limit 
	model6ratiolower = model6r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model6sloperatiolower = model6ratiolower[2];

	//slope ratio upper limit 
	model6ratioupper = model6r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model6sloperatioupper = model6ratioupper[2];
	
	model6r << close window;
	
		//model 6 quad and linearity ratio
		model6 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group( "Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model6r = model6 << report;
		model6quadss = model6r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model6conc = model6quadss[4];
		model6quad = model6quadss[7];
		model6quadp = abs(( model6quad * 1 ) / (model6conc * 2))* 100;//Linearity Ratio Formula
		model6r << close window;


	//Model 7) Test High Dose Excluded
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where(!Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MaximumDose ) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	model7 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard ), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model7r = model7 << report;
	model7rootmean = model7r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model7rsquare = model7r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model7r2 = model7rsquare[1];
	model7rmse = model7rootmean[1];

	//slope ratio value
	model7ratio = model7r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model7sloperatio = model7ratio[2];
	
	//slope ratio lower limit 
	model7ratiolower = model7r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model7sloperatiolower = model7ratiolower[2];

	//slope ratio upper limit 
	model7ratioupper = model7r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model7sloperatioupper = model7ratioupper[2];
	
	model7r << close window;
	
		//model 7 quad and linearity ratio
		model7 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group("Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model7r = model7 << report;
		model7quadss = model7r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model7conc = model7quadss[4];
		model7quad = model7quadss[7];
		model7quadp = abs(( model7quad * 1 ) / (model7conc * 2))* 100;//Linearity Ratio Formula
		model7r << close window;



	//Model 8) STD Low Dose and Test High Dose Excluded
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where( Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MinimumDose ) << exclude;
	dtsubset << select where(!Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MaximumDose ) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	model8 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard ), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model8r = model8 << report;
	model8rootmean = model8r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model8rsquare = model8r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model8r2 = model8rsquare[1];
	model8rmse = model8rootmean[1];

	//slope ratio value
	model8ratio = model8r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model8sloperatio = model8ratio[2];
	
	//slope ratio lower limit 
	model8ratiolower = model8r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model8sloperatiolower = model8ratiolower[2];

	//slope ratio upper limit 
	model8ratioupper = model8r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model8sloperatioupper = model8ratioupper[2];
	
	model8r << close window;
	
		//model 8 quad and linearity ratio
		model8 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group( "Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model8r = model8 << report;
		model8quadss = model8r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model8conc = model8quadss[4];
		model8quad = model8quadss[7];
		model8quadp = abs(( model8quad * 1 ) / (model8conc * 2))* 100;//Linearity Ratio Formula
		model8r << close window;


	//Model 9) STD High Dose and Test Low Dose Excluded
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select where( Contains(:Name("Group"),"Std")& :Name( "Log10 MOI" ) == MaximumDose ) << exclude;
	dtsubset << select where(!Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MinimumDose ) << exclude;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	model9 = Fit Curve(
	Y( :Name( "Log10 Vg/mL" ) ),
	X( :Log10 MOI),
	Group( :Group),
	Fit Linear(
		Equivalence Test(
			Reference Group(rstandard ), 
			Equivalence with Ratios(
				1,
				Set Decision Lines( 0.5, 1.5 ),
				Show Summary Report( 1 )
				)
			)
		)
	);
	model9r = model9 << report;
	model9rootmean = model9r["Model Comparison"][columnbox( "RMSE" )] << getasmatrix;
	model9rsquare = model9r["Model Comparison"][columnbox( "R-Square" )] << getasmatrix;
	model9r2 = model9rsquare[1];
	model9rmse = model9rootmean[1];

	//slope ratio value
	model9ratio = model9r["Equivalence Summary"][columnbox( "Ratio")]<< get as matrix;
	model9sloperatio = model9ratio[2];
	
	//slope ratio lower limit 
	model9ratiolower = model9r["Equivalence Summary"][columnbox( "Lower Confidence Limit")]<< get as matrix;
	model9sloperatiolower = model9ratiolower[2];

	//slope ratio upper limit 
	model9ratioupper = model9r["Equivalence Summary"][columnbox( "Upper Confidence Limit")]<< get as matrix;
	model9sloperatioupper = model9ratioupper[2];
	
	model9r << close window;

		//model 9 quad and linearity ratio
		model9 =Fit Model(
		Y(:Name( "Log10 Vg/mL" ) ),
		Effects(
			:Group,
			:Name( "Log10 MOI" ),
			:Group* :Name( "Log10 MOI" ),
			:Name( "Log10 MOI" ) * :Name( "Log10 MOI" )
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Concentration( 2.5, Lock( 0 ), Show( 1 ) ),
					Group( "Std", Lock( 0 ), Show( 1 ) )
				)
			),
			:Name("Log10 Vg/mL")<< {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Lack of Fit( 0 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
			)
		);
		model9r = model9 << report;
		model9quadss = model9r["Scaled Estimates"][columnbox( "Scaled Estimate" )] << getasmatrix;
		model9conc = model9quadss[4];
		model9quad = model9quadss[7];
		model9quadp = abs(( model9quad * 1 ) / (model9conc * 2)) * 100;//Linearity Ratio Formula
		model9r << close window;


	//Build the validity lists and Model Selection Table
	parallellist = List();
	parallellowerlist = List();
	parallelupperlist = List();
	modellist = List();
	linearitylist = List();
	r2list = List();
	rmselist = List();
	
	//Parallel List of slope ratio
	parallellist[1] = model1sloperatio;
	parallellist[2] = model2sloperatio;
	parallellist[3] = model3sloperatio;
	parallellist[4] = model4sloperatio;
	parallellist[5] = model5sloperatio;
	parallellist[6] = model6sloperatio;
	parallellist[7] = model7sloperatio;
	parallellist[8] = model8sloperatio;
	parallellist[9] = model9sloperatio;
	
	//Parallel List of slope ratio lower CI
	parallellowerlist[1] = model1sloperatiolower;
	parallellowerlist[2] = model2sloperatiolower;
	parallellowerlist[3] = model3sloperatiolower;
	parallellowerlist[4] = model4sloperatiolower;
	parallellowerlist[5] = model5sloperatiolower;
	parallellowerlist[6] = model6sloperatiolower;
	parallellowerlist[7] = model7sloperatiolower;
	parallellowerlist[8] = model8sloperatiolower;
	parallellowerlist[9] = model9sloperatiolower;
	
	//Parallel List of slope ratio of upper CI
	parallelupperlist[1] = model1sloperatioupper;
	parallelupperlist[2] = model2sloperatioupper;
	parallelupperlist[3] = model3sloperatioupper;
	parallelupperlist[4] = model4sloperatioupper;
	parallelupperlist[5] = model5sloperatioupper;
	parallelupperlist[6] = model6sloperatioupper;
	parallelupperlist[7] = model7sloperatioupper;
	parallelupperlist[8] = model8sloperatioupper;
	parallelupperlist[9] = model9sloperatioupper;

	//Model List
	modellist[1] = "Model 1, All Doses";
	modellist[2] = "Model 2, Low Standard and Test Doses Excluded";
	modellist[3] = "Model 3, High Standard and Test Doses Excluded";
	modellist[4] = "Model 4, Standard Low Dose Only Excluded";
	modellist[5] = "Model 5, Standard High Dose Only Excluded";
	modellist[6] = "Model 6, Test Low Dose Only Excluded";
	modellist[7] = "Model 7, Test High Dose Only Excluded";
	modellist[8] = "Model 8, Standard Low Dose and Test High Dose Excluded";
	modellist[9] = "Model 9, Standard High Dose and Test Low Dose Excluded";
	
	//Linearity List
	linearitylist[1] = model1quadp;
	linearitylist[2] = model2quadp;
	linearitylist[3] = model3quadp;
	linearitylist[4] = model4quadp;
	linearitylist[5] = model5quadp;
	linearitylist[6] = model6quadp;
	linearitylist[7] = model7quadp;
	linearitylist[8] = model8quadp;
	linearitylist[9] = model9quadp;
	
	//R2 List
	r2list[1] = model1r2;
	r2list[2] = model2r2;
	r2list[3] = model3r2;
	r2list[4] = model4r2;
	r2list[5] = model5r2;
	r2list[6] = model6r2;
	r2list[7] = model7r2;
	r2list[8] = model8r2;
	r2list[9] = model9r2;
	
	//RMSE List
	rmselist[1] = model1rmse;
	rmselist[2] = model2rmse;
	rmselist[3] = model3rmse;
	rmselist[4] = model4rmse;
	rmselist[5] = model5rmse;
	rmselist[6] = model6rmse;
	rmselist[7] = model7rmse;
	rmselist[8] = model8rmse;
	rmselist[9] = model9rmse;

	//Build the Masking and Validity Criteria Table and Select the Best Model
	dtmasking = New Table( "Masking and Validity","invisible" );
	dtmasking << add rows( 9 );
	dtmasking << New Column( "Model", character, set values( modellist ) );
	dtmasking << New Column( "Parallelism Slope Ratio", continuous, set values( parallellist ) );
	dtmasking << New Column( "Parallelism Slope Ratio Lower 95%", continuous, set values( parallellowerlist ) );
	dtmasking << New Column( "Parallelism Slope Ratio Upper 95%", continuous, set values( parallelupperlist ) );	
	dtmasking << New Column( "Linearity Ratio", continuous, set values( linearitylist ) );
	dtmasking << New Column( "R2", continous, set values( r2list ) );
	dtmasking << New Column( "RMSE", continous, set values( rmselist ) );
	dtmasking << delete columns( :Column 1 );
	:Name("Parallelism Slope Ratio") << Format( "Fixed Dec", 7, 3 );
	:Name("Parallelism Slope Ratio Lower 95%") << Format( "Fixed Dec", 7, 3)<<hide(1);
	:Name("Parallelism Slope Ratio Upper 95%") << Format( "Fixed Dec", 7, 3)<<hide(1); 
	:Linearity Ratio << Format( "Fixed Dec", 7, 3 );
	:R2 << Format( "Fixed Dec", 7, 3 );
	:RMSE << Format( "Fixed Dec", 7, 3 );
	
	//Determine the model
	dtmasking<<New Column( "Linearity Test",
	Character,
	"Nominal",
	Formula( If( :Linearity Ratio <= linearity_limit, "Ok for Linearity", "Fail for Linearity" ) ),
	Set Display Width( 134 )
);
:Linearity Test<<hide;
	dtmasking<<New Column( "Parallelism Test",
	Character,
	"Nominal",
	Formula(
		If(
			:Name( "Parallelism Slope Ratio" ) >= lowerparallel_limit &
			:Name( "Parallelism Slope Ratio" ) <= upperparallel_limit,
			"Ok for Parallelism",
			"Fail for Parallelism"
		)
	)
);
:Parallelism Test<<hide;
	dtmasking<<New Column( "Combined",
	Character,
	"Nominal",
	Formula( :Linearity Test || " " || :Parallelism Test ),
	Set Display Width( 304 )
);
:Combined<<hide;


	dtmasking << New Column( "Validity Evaluation",
		Character,
		"Nominal",
		Set Property(
			"Value Colors",
			{"Fails both Parallelism and Linearity" = 35, "Fails Parallelism and is Linear" = -16768477,
			"Parallel and Fails Linearity" = -16768477, "Parallel and Linear" = -15400938}
		),
		Color Cell by Value,
		Formula(
			If(
				:Parallelism Test == "Ok for Parallelism" & :Linearity Test == "Ok for Linearity", "Parallel and Linear",
				:Parallelism Test != "Ok for Parallelism" & :Linearity Test == "Ok for Linearity", "Fails Parallelism and is Linear",
				:Parallelism Test== "Ok for Parallelism"& :Linearity Test != "Ok for Linearity", "Parallel and Fails Linearity",
				:Parallelism Test != "Ok for Parallelism"& :Linearity Test != "Ok for Linearity", "Fails both Parallelism and Linearity"
			)
		)
	);
	
	dtmasking << New Column( "Masking Rank",
		Numeric,
		"Continuous",
		Format( "Best", 12 ),
		Formula(
			Match( :Validity Evaluation,
				"Fails Parallelism and is Linear", 2,
				"Parallel and Fails Linearity", 2,
				"Parallel and Linear", 1,
				"Fails both Parallelism and Linearity", 3
			)
		), 

	);
	
	
	:Masking Rank<<hide(1);
	
	dtmasking<<New Column( "Modelling Rank",
		Numeric,
		"Continuous",
		Format( "Best", 12 ),
		Formula(
			If(
				(Contains( :Model, "1" ) | Contains( :Model, "2" ) |
				Contains( :Model, "3" )) & :Masking Rank == 1,
				1,
				2
			)
		)
	);
	
	//create column for difference of slope ratio from 1
	dtmasking<<New Column( "Delta",
		Numeric,
		"Continuous",
		Format( "Best", 12 ),
		Formula( Abs( :Name( "Parallelism Slope Ratio" ) - 1 ) )
	);
	
	
	:Delta<<hide(1);
	
	modellingranklist=:Modelling Rank<<get as matrix;
	
	:Modelling Rank <<hide(1);
	
	if(contains(modellingranklist,1),
	
	//sort based on passing both parallelism and linearity and having the smallest difference in slope ratio to 1
	dtmasking << Sort(
		By(  :Modelling Rank, :Masking Rank, :Delta ),
		Order( Ascending, Ascending, Ascending ),
		replace table( 1 )
	);
	,
	//sort based on passing both parallelism and linearity and having the smallest difference in slope ratio to 1
	dtmasking << Sort(
		By( :Masking Rank, :Delta ),
		Order( Ascending, Ascending ),
		replace table( 1 )
	);
);	
	dtmasking << New Column( "Selected Model", Character, "Nominal", Formula( If( Row() == 1, :Model[1] ) ), );
	modelgetter = :Selected Model << get values;
	plamodel = modelgetter[1];
	paralellsloperatios = :Name("Parallelism Slope Ratio") << get values;
	paralellsloperatioslower = :Name("Parallelism Slope Ratio Lower 95%") <<get values;
	paralellsloperatiosupper = :Name("Parallelism Slope Ratio Upper 95%") <<get values;
	linearityprobs = :Linearity Ratio << get values;
	sloperatioparallel = paralellsloperatios[1];
	sloperatioparallellower = paralellsloperatioslower[1];
	sloperatioparallelupper = paralellsloperatiosupper[1];
	plalinearityprob = linearityprobs[1];
	
	selectedmodellist[j]=plamodel;

	//Model Section header
	modelreport = New Window( "Plate Map Report",
		V List Box( H List Box( String Col Box( "", {liner} ) ) ),
		V List Box(
			String Col Box( "", {spacer} ),
			H List Box( modelname = Text Box(concat(samplenames[j],"  Model Selection"))),
			V List Box( H List Box( String Col Box( "", {liner} ) ) ), 

		),
		String Col Box( "", {spacer} ), 

	);
	modelname << Set Font Size( 16 );
	modelname << Font Color( "Blue" ) << set Font Style( "Bold" )<<set wrap (10000);
	modelreport << journal << close window;

	dtmasking<<journal;
	close(dtmasking, no save);
	
	//Select the Dose Subset and Masking
	dtsubset << clear row states;
	ExcludeOutliers;
	ExcludeDroplets;
	dtsubset << select all rows;
	dtsubset << invert row selection;

	If( plamodel == "Model 1, All Doses",
		a = 1 + 1, 

	);
	If( plamodel == "Model 2, Low Standard and Test Doses Excluded",
		dtsubset << select where( :Name( "Log10 MOI" ) == MinimumDose |:Name( "Log10 MOI" ) == MinimumDose ) << exclude, 

	);
	If( plamodel == "Model 3, High Standard and Test Doses Excluded",
		dtsubset << select where( :Name( "Log10 MOI" ) == MaximumDose |:Name( "Log10 MOI" ) == MaximumDose) << exclude, 

	);
	If( plamodel == "Model 4, Standard Low Dose Only Excluded",
		dtsubset << select where(Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MinimumDose ) << exclude, 

	);
	If( plamodel == "Model 5, Standard High Dose Only Excluded",
		dtsubset << select where( Contains(:Name("Group"),"Std")& :Name( "Log10 MOI" ) == MaximumDose ) << exclude, 

	);
	If( plamodel == "Model 6, Test Low Dose Only Excluded",
		dtsubset << select where(!Contains(:Name("Group"),"Std")& :Name( "Log10 MOI" ) == MinimumDose ) << exclude, 

	);
	If( plamodel == "Model 7, Test High Dose Only Excluded",
		dtsubset << select where(!Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MaximumDose ) << exclude, 

	);
	If( plamodel == "Model 8, Standard Low Dose and Test High Dose Excluded",
		dtsubset << select where(Contains(:Name("Group"),"Std")& :Name( "Log10 MOI" ) == MinimumDose ) << exclude;
		dtsubset << select where(!Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MaximumDose ) << exclude;
	, 

	);
	If( plamodel == "Model 9, Standard High Dose and Test Low Dose Excluded",
		dtsubset << select where(Contains(:Name("Group"),"Std") & :Name( "Log10 MOI" ) == MaximumDose ) << exclude;
		dtsubset << select where(!Contains(:Name("Group"),"Std")  & :Name( "Log10 MOI" ) == MinimumDose ) << exclude;
	);
	dtsubset << select all rows;
	dtsubset << invert row selection;

	//Max and Min for the y axis in the graphs
	RangeMax = col max(:Name("Log10 Vg/mL"));
	RangeMin = col min(:Name("Log10 Vg/mL"));

	If( samplenum == 4&platetotal=="3", 


//Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
	, 
	
if(totalrownumbers==192&j==1|totalrownumbers==192&j==2|totalrownumbers==192&j==3,

//Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
,
if(totalrownumbers==96&j==1|totalrownumbers==96&j==2|totalrownumbers==96&j==3,

//Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
,
if(totalrownumbers==112,

//Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
,
if(totalrownumbers==120,

//Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
,
if(totalrownumbers==152&j==3,

//Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
,
		Empty();
	);
			);
		);
	);
);

);



	//constrained EC50 at fixed position for TA
	current data table(dtsubset);
ec50TAcon = Fit Model(
	Y( :Name( "Log10 Vg/mL" ) ),
	Effects(:Group, :Name( "Log10 MOI" ) ),
	Personality( "Standard Least Squares" ),
	Emphasis( "Effect Leverage" ),
	Run(
		:Name( "Log10 Vg/mL" ) << {Summary of Fit( 1 ), Analysis of Variance( 1 ), Parameter Estimates( 1 ),
		Scaled Estimates( 1 ), Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 1 ),
		Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ), Plot Effect Leverage( 1 ),
		Plot Residual by Normal Quantiles( 0 ), Box Cox Y Transformation( 0 ), Show VIF( 1 ),
		Inverse Prediction( Response( fixedTAvalue ), Term Value( Name( "Log10 MOI (Vg/cell)" )(.), Group( All )) )},
		Effect Summary( 0 )
	),
	SendToReport(
		Dispatch(
			{"Response Log10 Vg/mL", "Inverse Prediction"},
			"2",
			ScaleBox,
			{Min( 3.5 ), Max( 6.5 ), Inc( 0.5 ), Minor Ticks( 0 )}
		)
	)
);
ec50TAconr = ec50TAcon << report;
dt_Inf_TA_con = ec50TAconr["Response Log10 Vg/mL", "Inverse Prediction", Table Box( 1 )] << Make Into Data Table;
ec50TAlog =  dt_Inf_TA_con:Name("Predicted Log10 MOI")[dt_Inf_TA_con << Get Rows Where(:Group == samplenames[j])][1];
ec50TAdose = 10 ^ (ec50TAlog);
ec50TAconr << close window;
close(dt_Inf_TA_con, no save);


//unconstrained EC50 at fixed position for TA
ec50TAuncon = Fit Model(
	Y( :Name( "Log10 Vg/mL" ) ),
		Effects( :Group, :Name( "Log10 MOI" ), :Group * :Name( "Log10 MOI" ) ),
	Personality( "Standard Least Squares" ),
	Emphasis( "Effect Leverage" ),
	Run(
		:Name( "Log10 Vg/mL" ) << {Summary of Fit( 1 ), Analysis of Variance( 1 ), Parameter Estimates( 1 ),
		Scaled Estimates( 1 ), Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 1 ),
		Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ), Plot Effect Leverage( 1 ),
		Plot Residual by Normal Quantiles( 0 ), Box Cox Y Transformation( 0 ), Show VIF( 1 ),
		Inverse Prediction( Response( fixedTAvalue ), Term Value( Name( "Log10 MOI (Vg/cell)" )(.), Group( All ) ) )},
		Effect Summary( 0 )
	),
	SendToReport(
		Dispatch(
			{"Response Log10 Vg/mL", "Inverse Prediction"},
			"2",
			ScaleBox,
			{Min( 3.5 ), Max( 6.5 ), Inc( 0.5 ), Minor Ticks( 0 )}
		)
	)
);
ec50TAunconr = ec50TAuncon << report;
dt_Inf_TA_Uncon = ec50TAunconr["Response Log10 Vg/mL", "Inverse Prediction", Table Box( 1 )] << Make Into Data Table;
ec50TAunconlog =  dt_Inf_TA_Uncon:Name("Predicted Log10 MOI")[dt_Inf_TA_Uncon << Get Rows Where(:Group == samplenames[j])][1];
ec50TAuncondose = 10 ^ (ec50TAunconlog);
ec50TAunconr << close window;
close(dt_Inf_TA_Uncon, no save);

infectparticleresult = num(nominaldose)/ec50TAdose;




if(nitems(samplenames)==2,

////Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
,

empty();
);

	//Test Sample Graphs header
	graphreport = New Window( "Plate Map Report",
		V List Box( H List Box( String Col Box( "", {liner} ) ) ),
		V List Box(
			String Col Box( "", {spacer} ),
			H List Box( graphname = Text Box(concat(samplenames[j]," ","Graphs "))) ,
			V List Box( H List Box( String Col Box( "", {liner} ) ) ), 

		),
		String Col Box( "", {spacer} ), 

	);
	graphname << Set Font Size( 16 );
	graphname << Font Color( "Blue" ) << set Font Style( "Bold" )<<set wrap(1000);
	graphreport << journal << close window;

	current data table(dtsubset);
	dtsubset<<New Column( "Sampling Type",
		Character,
		"Nominal",
		Formula(
			If( Contains( :Group, "Std" ),
				"Reference Standard",
				"Drug Product"
			)
		)
	);

	//Calculate Unconstrained RI
	//Calculate Constrained RP
	//Calculate RP Delta
	FMUnconstrained = dtsubset << Fit Model(invisible,
		Y( :Name("Log10 Vg/mL") ),
		Effects(
			:Name( "Log10 MOI" ),
			:Sampling Type,
			:Name( "Log10 MOI" ) * :Sampling Type
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Name( "Log10 MOI" )(4.8356, Lock( 0 ), Show( 1 )),
				)
			),
			:Name("Log10 Vg/mL") << {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
		)
	);
	ResponseMean = Report(FMUnconstrained)[OutlineBox("Summary of Fit")][Number Col Box(1)][4];
	FMUnconstrained << Inverse Prediction(
		Response( ResponseMean ),
		Term Value( Name( "Log10 MOI" )(.), Sampling Type( All ) )
	);
	FMConstrained = dtsubset << Fit Model(invisible,
		Y( :Name("Log10 Vg/mL") ),
		Effects(
			:Name( "Log10 MOI" ),
			:Sampling Type
		),
		Personality( "Standard Least Squares" ),
		Emphasis( "Effect Leverage" ),
		Run(
			Profiler(
				1,
				Confidence Intervals( 1 ),
				Term Value(
					Name( "Log10 MOI" )(4.8356, Lock( 0 ), Show( 1 )),
				)
			),
			:Name("Log10 Vg/mL") << {Summary of Fit( 1 ), Analysis of Variance( 1 ),
			Parameter Estimates( 1 ), Scaled Estimates( 1 ),
			Plot Actual by Predicted( 1 ), Plot Residual by Predicted( 0 ),
			Plot Residual by Row( 1 ), Plot Studentized Residuals( 0 ),
			Plot Effect Leverage( 1 ), Plot Residual by Normal Quantiles( 0 ),
			Box Cox Y Transformation( 0 ), Show All Confidence Intervals( 1 ),
			Show VIF( 1 )}
		)
	);
	FMconstrained << Inverse Prediction(
		Response( ResponseMean ),
		Term Value( Name( "Log10 MOI" )(.), Sampling Type( All ) )
	);

	IPCon = Report(FMConstrained)[Outline Box( "Inverse Prediction" )][Table Box( 1 )] << get as matrix();
	IPUnCon = Report(FMUnconstrained)[Outline Box( "Inverse Prediction" )][Table Box( 1 )] << get as matrix();
	doseresponsetests = Report(FMConstrained)["Effect Tests"][columnbox( "Prob > F" )] << getasmatrix;
	doseresponsetest = doseresponsetests[1];
	r2constrained = Report(FMConstrained)["Summary of Fit"][columnbox( 1 )] << getasmatrix;
	r2constrained = r2constrained[1];
	conslopes =  Report(FMConstrained)["Parameter Estimates"][columnbox( "Estimate" )] << getasmatrix;
	conslope = conslopes[2];
	UnconstrainedPotency = 10 ^ IPUnCon[2,2]/10 ^ IPUnCon[1,2]; //Ref/Std
	UnconstrainedPotencyL95 = 10 ^ IPUnCon[2,2]/10 ^ IPUnCon[1,4]; //Ref Predicted Dose/Test Upper 95
	UnconstrainedPotencyU95 = 10 ^ IPUnCon[2,2]/10 ^ IPUnCon[1,3]; //Ref Predicted Dose/Test Lower 95
	ConstrainedPotency = 10 ^ IPCon[2,2]/10 ^ IPCon[1,2]; //Ref/Std
	ConstrainedPotencyL95 = 10 ^ IPCon[2,2]/10 ^ IPCon[1,4]; //Ref Predicted Dose/Test Upper 95
	ConstrainedPotencyU95 = 10 ^ IPCon[2,2]/10 ^ IPCon[1,3]; //Ref Predicted Dose/Test Lower 95
	ci95range=ConstrainedPotencyU95*100-ConstrainedPotencyL95*100;
	CITolerance = (( ci95range/ (num(RPUSL) - num(RPLSL))) * 100);

	dosetestlist[j]=doseresponsetest;
	
	CIRangelist[j]=ci95range;
	
	CITolerancelist[j]=CITolerance;
	
	current data table(dtsubset);
	

	//Create Graphs	
	ExcludeOutliers;
	ExcludeDroplets;
	Biv1 = Bivariate(invisible,
		Y( :Name("Log10 Vg/mL") ),
		X( :Name( "Log10 MOI" ) ),
		Fit Where(
			:Sampling Type == "Reference Standard",
			Fit Each Value( {Confid Curves Fit( 0 ), Line Color( {213, 72, 87} )} )
		),
		Fit Where(
			:Sampling Type =="Drug Product",
			Fit Each Value( {Confid Curves Fit( 0 ), Line Color( {64, 111, 223} )} )
		),
		SendToReport(
			Dispatch(
				{},
				"Bivariate Fit of Data By Log10 MOI",
				OutlineBox,
				{Set Title( "Means by MOI" )}
			),
			Dispatch(
				{},
				"1",
				ScaleBox,
				{Format( "Best", Use thousands separator( 0 ), 12 ),
				Min(  0.43*MinimumDose ), Max( 1.1*MaximumDose), Inc( 0.1 ), Minor Ticks( 0 ),
					Label Row(
				{Label Orientation( "Vertical" ),Show Major Labels( 0 ), Show Major Ticks( 0 ),
				Show Minor Ticks( 0 )}
			)
				}
			),
				Dispatch(
				{},
				"2",
				ScaleBox,
				{Format( "Best", Use thousands separator( 0 ), 12 ), Min( RangeMin*0.83), Max( RangeMax*1.08 ),
				Inc( 0.2 ), Minor Ticks( 0 ), Label Row( Show Major Grid( 1 ) )}				),
			Dispatch(
				{},
				"Bivar Plot",
				FrameBox,
				{Frame Size( 250, 400 ), DispatchSeg( Line Seg( 1 ), {Line Color( {213, 72, 87} )} ),
				DispatchSeg( Line Seg( 2 ), {Line Color( {64, 111, 223} )} )}
			),
			Dispatch( {}, "Log10 MOI", TextEditBox, {Set Text( "MOI" )} ),
		)
	);
	For(aa=1,aa<= nitems(dilutionlister),aa++,
			Report(Biv1)[ScaleBox(1)] << Add Ref Line( log10(num(dilutionlister[aa])), "Solid", "Medium Light Gray", char(round(num(dilutionlister[aa]),2)), 1 );
	);
	Biv2 = Bivariate(invisible,
		Y( :Name("Log10 Vg/mL") ),
		X( :Name( "Log10 MOI" ) ),
		Fit Where( :Sampling Type =="Reference Standard", Fit Line( {Confid Curves Fit( 0 ), Confid Shaded Fit( 0 ), Line Color( {213, 72, 87} )} ) ),
		Fit Where( :Sampling Type == "Drug Product", Fit Line( {Confid Curves Fit( 0 ), Confid Shaded Fit( 0 ), Line Color( {64, 111, 223} )} ) ),
		SendToReport(
			Dispatch(
				{},
				"Bivariate Fit of Data By Log10 MOI",
				OutlineBox,
				{Set Title( "Unconstrained Parallel Line Analysis" )}
			),
			Dispatch(
				{},
				"1",
				ScaleBox,
				{Format( "Best", Use thousands separator( 0 ), 12 ),
				Min( 0.43*MinimumDose ), Max( 1.1*MaximumDose), Inc( 0.1 ), Minor Ticks( 0 ),
					Label Row(
				{Label Orientation( "Vertical" ),Show Major Labels( 0 ), Show Major Ticks( 0 ),
				Show Minor Ticks( 0 )}
			)
				}
			),
				Dispatch(
				{},
				"2",
				ScaleBox,
				{Format( "Best", Use thousands separator( 0 ), 12 ), Min( RangeMin*0.83), Max( RangeMax*1.08 ),
				Inc( 0.2 ), Minor Ticks( 0 ), Label Row( Show Major Grid( 1 ) )}				),
			Dispatch(
				{},
				"Bivar Plot",
				FrameBox,
				{Frame Size( 250, 400 ), DispatchSeg( Line Seg( 1 ), {Line Color( {213, 72, 87} )} ),
				DispatchSeg( Line Seg( 2 ), {Line Color( {64, 111, 223} )} )}
			),
			Dispatch( {}, "Log10 MOI", TextEditBox, {Set Text( "MOI" )} ),
			
		)
	);
	For(aa=1,aa<= nitems(dilutionlister),aa++,
			Report(Biv2)[ScaleBox(1)] << Add Ref Line( log10(num(dilutionlister[aa])), "Solid", "Medium Light Gray", char(round(num(dilutionlister[aa]),2)), 1 );
	);
	
	
	Biv3 = Bivariate(invisible,
		Y( :Name("Log10 Vg/mL") ),
		X( :Name( "Log10 MOI" ) ),
		Fit Where( :Sampling Type == "Reference Standard", Fit Special( Slope( conslope ), {Confid Curves Fit( 0 ), Confid Shaded Fit( 0 ), Line Color( {213, 72, 87} )} ) ),
		Fit Where( :Sampling Type == "Drug Product", Fit Special( Slope( conslope ), {Confid Curves Fit( 0 ), Confid Shaded Fit( 0 ), Line Color( {64, 111, 223} )} ) ),
		SendToReport(
			Dispatch(
				{},
				"Bivariate Fit of Data By Log10 MOI",
				OutlineBox,
				{Set Title( "Constrained Parallel Line Analysis" )}
			),
			Dispatch(
				{},
				"1",
				ScaleBox,
				{Format( "Best", Use thousands separator( 0 ), 12 ),
				Min(  0.43*MinimumDose ), Max( 1.1*MaximumDose), Inc( 0.1 ), Minor Ticks( 0 ),
					Label Row(
				{Label Orientation( "Vertical" ),Show Major Labels( 0 ), Show Major Ticks( 0 ),
				Show Minor Ticks( 0 )}
			)
				}
			),
				Dispatch(
				{},
				"2",
				ScaleBox,
				{Format( "Best", Use thousands separator( 0 ), 12 ), Min( RangeMin*0.83), Max( RangeMax*1.08 ),
				Inc( 0.2 ), Minor Ticks( 0 ), Label Row( Show Major Grid( 1 ) )}				),
			Dispatch(
				{},
				"Bivar Plot",
				FrameBox,
				{Frame Size( 250, 400 ), DispatchSeg( Line Seg( 1 ), {Line Color( {213, 72, 87} )} ),
				DispatchSeg( Line Seg( 2 ), {Line Color( {64, 111, 223} )} ),
				Row Legend(
					Sampling Type,
					Color( 1 ),
					Color Theme( "JMP Default" ),
					Marker( 0 ),
					Marker Theme( "" ),
					Continuous Scale( 0 ),
					Reverse Scale( 1 ),
					Excluded Rows( 0 )
				)}
			),
			Dispatch( {}, "Log10 MOI", TextEditBox, {Set Text( "MOI" )} ),
		)
	);
	
	
		
	For(aa=1,aa<= nitems(dilutionlister),aa++,
			Report(Biv3)[ScaleBox(1)] << Add Ref Line( log10(num(dilutionlister[aa])), "Solid", "Medium Light Gray", char(round(num(dilutionlister[aa]),2)), 1 );
	);

	CurveComparison = H List Box(
		OutlineBox("Means by Concentration",Report(Biv1)[PictureBox(1)]),
		OutlineBox("Unconstrained Parallel Line Analysis",Report(Biv2)[PictureBox(1)]),
		OutlineBox("Constrained Parallel Line Analysis",Report(Biv3)[PictureBox(1)]),
	);
	CurveComparison << journal();
		
	
	Biv1 << close window(1);
	Biv2 << close window(1);
	Biv3 << close window(1);

	
	//Potency Report
	dtrp = New Table( "Potency Report","invisible" );
	dtrp << add rows( 1 );
	dtrp << New Column( "EC50 Ref", continuous, Format( "Fixed Dec", 2 ), Set Values({10 ^ (IPCon[2,2])}) );
	dtrp << New Column( "EC50 Test", continuous, Format( "Fixed Dec", 2 ), Set Values({10 ^ (IPCon[1,2])}) );
	dtrp << New Column( "RI Uncorrected", continuous, Format( "Fixed Dec", 1 ), Set Values({ConstrainedPotency * 100} ) );
	dtrp << delete columns( :Column 1 );
	dtrp << New Column( "Reference CF", continuous, Set Values( {ReferenceLotCF} ) );
	dtrp << New Column( "Reference Stability CF", continuous, Set Values( {StabilityCF} ) );
	dtrp << New Column( "Relative Infectivity Reportable Result", continuous, Format( "Fixed Dec", 1 ),formula( :Reference CF + :Reference Stability CF + :RI Uncorrected) );
	dtrp << New Column( "Assay RI Upper 95%", continuous, Format( "Fixed Dec", 1 ),formula( ReferenceLotCF + StabilityCF +  ConstrainedPotencyU95 * 100 ) );
	dtrp << New Column( "Assay RI Lower 95%", continuous, Format( "Fixed Dec", 1 ),formula( ReferenceLotCF + StabilityCF + ConstrainedPotencyL95 * 100 ) );
	dtrp << New Column( "Upper Spec Limit", continuous, Set Values( {num(RPUSL)} ) );
	dtrp << New Column( "Lower Spec Limit", continuous, Set Values( {num(RPLSL)}) );
	dtrp << New Column("CI Range", continuous, Format( "Fixed Dec", 1 ), set values ({CI95range}));
	dtrp << New Column( "CI Range as % of Tolerance", continous, Format( "Fixed Dec", 1 ), Set Values( {CITolerance} ) );
	dtrp << New Column( "CI Range % of Tolerance Check",
		Character,
		"Nominal",
		Formula( If( :Name("CI Range as % of Tolerance")> 60, "Additional Bioassay Runs are Required", "Bioassay Results are Reportable" ) ),
		Set Property( "Value Colors", {"Additional Bioassay Runs are Required" = -16768477, "Bioassay Results are Reportable" = -15400938} ),
		Color Cell by Value,
	);
	
	
			//Read the values of the  DP plate map again to get the validity limits
	dtPlateMap = Open(
		configfile,
		Worksheets( "Infectivity Configuration 0.15" ),
		Use for all sheets( 1 ),
		Concatenate Worksheets( 0 ),
		Create Concatenation Column( 0 ),
		Worksheet Settings(
			1,
			Has Column Headers( 1 ),
			Number of Rows in Headers( 1 ),
			Headers Start on Row( 1 ),
			Data Starts on Row( 2 ),
			Data Starts on Column( 1 ),
			Data Ends on Row( 0 ),
			Data Ends on Column( 0 ),
			Replicated Spanned Rows( 1 ),
			Replicated Spanned Headers( 0 ),
			Suppress Hidden Rows( 1 ),
			Suppress Hidden Columns( 1 ),
			Suppress Empty Columns( 1 ),
			Treat as Hierarchy( 0 ),
			Multiple Series Stack( 0 ),
			Import Cell Colors( 0 ),
			Limit Column Detect( 0 ),
			Column Separator String( "-" )
		)
	);
	//Read specs
	ValidityCriteria =list();
	ValidityCriteria[1]= "Dose Response Test";
	ValidityCriteria[2]= "Reference Standard Curve Depth";
	ValidityCriteria[3]= "% Relative Infectivity Delta (Constrained - Unconstrained)";
	ValidityCriteria[4]= "Parallelism Slope Ratio";
	ValidityCriteria[5]="Linearity Ratio";
	ValidityCriteria[6]= "Unconstrained EC50 Standard";
	ValidityCriteria[7]= "Number of Wells that Failed Accepted Droplets (<10000)";
	

	RPLSL= num(Column(2)[1]);
	RPUSL = num(Column(2)[2]);
	linearity_limit = num(Column(2)[11]);

	ValidityLSL =  list();
	ValidityLSL[1]="";
	ValidityLSL[2]=Column(2)[3];
	ValidityLSL[3]="";
	ValidityLSL[4]=Column(2)[9];
	ValidityLSL[5]="";
	ValidityLSL[6]=Column(2)[4];
	ValidityLSL[7]="";

	ValidityUSL =  list();
	ValidityUSL[1]=Column(2)[12];
	ValidityUSL[2]="";
	ValidityUSL[3]=Column(2)[6];
	ValidityUSL[4]=Column(2)[10];
	ValidityUSL[5]=Column(2)[11];
	ValidityUSL[6]=Column(2)[5];
	ValidityUSL[7]=Column(2)[17];

	upperparallel_limit = num(ValidityUSL[4]);
	lowerparallel_limit = num(ValidityLSL[4]);

	close(dtPlateMap, no save);

if(j==1&nitems(samplenames)!=2,

////Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;

,

if(j==5,

////Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;

,

empty();
);
);
	
	//Validity report
	LineBox;
	VSpacer(1);
	Text Box(concat(samplenames[j],"  Validity Report")) << Font Color( "Blue" ) << Set Font Size( 16 ) << set Font Style( "Bold" )  <<set wrap(10000)<< journal();
	LineBox;
	VSpacer(1);

	dtvalidity = New Table( "Validity","invisible" );
	dtvalidity << New Column( "Validity Criteria", character, set values( ValidityCriteria ), Set Display Width( 147 ) );
	dtvalidity << New Column( "LSL", continuous, set values( ValidityLSL ) );
	dtvalidity << New Column( "USL", continuous, set values( ValidityUSL ) );
	dtvalidity << New Column( "Validity Results", Format( "Fixed Dec", 12, 3 ), continuous, set values(
		{doseresponsetest,//Dose Response Test,
		refcurvedepth, //Curve Depth
			RPD = abs(ConstrainedPotency-UnConstrainedPotency)*100,//RP Delta%
		sloperatioparallel, //Parallelism slope ratio
		plalinearityprob, //Linearity ratio
		EC50RefUncon = ec50refunconfourdose,
		  //EC50
		 dropletsrescount //droplet count
		},
	) );
	dtvalidity<<select where(is missing(:Validity Criteria))<<delete rows<<clear select;
	dtvalidity<<New Column( "Assay Validity",
		Character,
		"Nominal",
		Formula(
				If(
					(:Validity Results >= :LSL | Is Missing( :LSL )) & (
					:Validity Results <= :USL | Is Missing( :USL )),
					"Passed Validity Criteria",
					"Failed Validity Criteria"
				)
			),
		Set Property(
			"Value Colors",
			{"Failed Validity Criteria" =  -16768477, "Passed Validity Criteria" =  -15400938}
		),
		Color Cell by Value,
		Set Display Width( 143 )
	);
	dtvalidity << New Column( "Overall Validity",
		Character,
		"Nominal",
		Formula(
			If( Row() == 1,
				If(
					:Assay Validity[1] == "Passed Validity Criteria" &
					:Assay Validity[2] == "Passed Validity Criteria" &
					:Assay Validity[3] == "Passed Validity Criteria" &
					:Assay Validity[4] == "Passed Validity Criteria" &
					:Assay Validity[5] == "Passed Validity Criteria" &
					:Assay Validity[6] == "Passed Validity Criteria" &
					:Assay Validity[7] == "Passed Validity Criteria",
					"Assay is Valid"
				,
					"Failed One or More Validity Criteria"
				)
			)
		),
		Set Property(
			"Value Colors",
			{"Failed One or More Validity Criteria" = -16768477, "Assay is Valid" =  -15400938}
		),
		Color Cell by Value,
		Set Display Width( 212 ) 
	);
	dtvalidity << journal;
	Reportable = :Overall Validity[1];
	finalparallellist[j]=:Validity Results[4];
	finallinearitylist[j]=:Validity Results[5];

	close(dtvalidity, no save);
	
	dtrp << set table variable( "Validity", Reportable );
	dtrp <<New Column( "OOS Validity",
	Character,
	"Nominal",
	Set Property(
		"Value Colors",
		{"Invalid Assay Results not Reportable" = -16768477,
		"Assay is Valid and OOS" = -16768477, "Assay is Valid and Within Limits" =
		-15400938}
	),
	Formula(
		If(
			:Validity == "Assay is Valid" & :Relative Infectivity Reportable Result >=
			Num( RPLSL ) & (:Validity == "Assay is Valid" &
			:Relative Infectivity Reportable Result <= Num( RPUSL )),
				"Assay is Valid and Within Limits",
			:Validity == "Assay is Valid" & :Relative Infectivity Reportable Result <
			Num( RPLSL ) | :Validity == "Assay is Valid" &
			:Relative Infectivity Reportable Result > Num( RPUSL ),
				"Assay is Valid and OOS",
			"Invalid Assay Results not Reportable"
		)
	),
	Color Cell by Value
);
	dtrp<<unlock(:OOS Validity);
	oosvaliditycol=:OOS Validity<<get values;
	oostest=oosvaliditycol[1];	

	
	LineBox;
	VSpacer(1);
	Text Box(concat(samplenames[j]," Relative Infectivity and Infectious Particle Ratio")) << Font Color( "Blue" ) << Set Font Size( 16 ) << set Font Style( "Bold" ) <<set wrap(10000)<< journal();
	LineBox;
	VSpacer(1);
	dtrp << journal();
	
	dtdelta= New Table("Unconstrained Report", "invisible");
	dtdelta << add rows(1);
	dtdelta << delete columns( :Column 1 );
	dtdelta << New Column( "Unconstrained RI", continuous, Format( "Fixed Dec", 12, 1 ), set values( {UnConstrainedPotency*100} ) );
	dtdelta << New Column( "Constrained RI", continuous, Format( "Fixed Dec", 12, 1 ), set values(  {ConstrainedPotency*100} ) );
	dtdelta << New Column( "Relative Infectivity Delta", continuous,  Format( "Fixed Dec", 12, 1 ), set values({RPD}));
	dtdelta << journal;

	RPdeltalist[j]=RPD;

	close(dtdelta, no save);
	
	dtir= new table("Infectious Particle Ratio Table","invisible");
	dtir<<add rows(1);
	dtir << delete columns( :Column 1 );
	dtir << New Column( "Infectious Particle Ratio", continuous, Format( "Fixed Dec", 12, 1 ), set values( {infectparticleresult} ) );
	dtir << New Column( "Infectious Particle Ratio Lower Limit", continuous, Format( "Fixed Dec", 12, 1 ), set values(  {infectpartLSL} ) );
	dtir << New Column( "Infectious Particle Ratio Upper Limit", continuous,  Format( "Fixed Dec", 12, 1 ), set values({infectpartUSL}));
	dtir << journal;
	
	close(dtir, no save);


	//Save the results 
	samplesec50ref[j] = 10 ^ (IPCon[2,2]);
	samplesec50test[j] = 10 ^ (IPCon[1,2]);

	samplesrp[j] = ConstrainedPotency * 100+ReferenceLotCF+StabilityCF;
	samplesrpu95[j] = ReferenceLotCF + StabilityCF + ConstrainedPotencyU95 * 100;
	samplesrpl95[j] = ReferenceLotCF + StabilityCF + ConstrainedPotencyL95 * 100;
	
	unconsamplesec50ref[j] = 10 ^ (IPUnCon[1,2]);
	unconsamplesec50test[j] = 10 ^ (IPUnCon[2,2]);
	unconsamplesrp[j] = UnconstrainedPotency * 100;
	unconsamplesrpu95[j] = UnconstrainedPotencyU95 * 100;
	unconsamplesrpl95[j] = UnconstrainedPotencyL95 * 100;
	
	//save the results for infectious particle ratios
	infectparticlelist[j]=infectparticleresult;

	overallvalidity[j] = reportable;
	//End of Sample Loop

	close(dtsubset, no save);
	
	if(j==1,
		//Page break
		pagebreaker = New Window( "     Nothing Really",
			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
		);
		pagebreaker << journal << close window;
	);


	//Tracking and Trending
	TrackingAndTrendingdt = Open( concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 RI Assay Tracking and Trending.jmp") );
	Try(TrackingAndTrendingdt << Add Rows(
		{
		:Script Date and Time = datetimestamper,
		:Script Version = ScriptVer ,
		:Configuration File Name = confignamer,
		:Assay Name ="Astellas KT430 Infectivity Assay",
		:Reference Standard = rstandard,
		:Date Assay Initiated =assaydate ,
		:Purpose =purposevalue ,
		:Bioassay Run ID =bioassayrun ,
		:Analyst Name = analystname,
		:Bioassay Preparation = bioassayprep,
		:Bioassay Revision = bioassayrev,
		:Signal =signalvalue ,
		:Method = methodvalue,
		:Instrument ID =instrumentid,
		:"Notes"n = AssayDetailsValues[13],
		:"Material 1"n =Material_1 ,
		:"Source 1"n = Source_1 ,
		:"Catalog 1"n = Catalog_1 ,
		:"Lot 1"n = Lot_1,
		:"Expiration 1"n = Expiration_1 ,
		:"Material 2"n = Material_2 ,
		:"Source 2"n = Source_2, 
		:"Catalog 2"n = Catalog_2 ,
		:"Lot 2"n = Lot_2 ,
		:"Expiration 2"n = Expiration_2 ,
		:"Material 3"n = Material_3 ,
		:"Source 3"n = Source_3 ,
		:"Catalog 3"n = Catalog_3 ,
		:"Lot 3"n = Lot_3 ,
		:"Expiration 3"n = Expiration_3,
		:"Material 4"n = Material_4,
		:"Source 4"n = Source_4 ,
		:"Catalog 4"n = Catalog _4 ,
		:"Lot 4"n = Lot_4,
		:"Expiration 4"n = Expiration_4 ,
		:"Material 5"n = Material_5 ,
		:"Source 5"n = Source_5,
		:"Catalog 5"n = Catalog_5 ,
		:"Lot 5"n =Lot_5 ,
		:"Expiration 5"n = Expiration_5 ,
		:"Material 6"n = Material_6 ,
		:"Source 6"n = Source_6,
		:"Catalog 6"n = Catalog_6 ,
		:"Lot 6"n = Lot_6 ,
		:"Expiration 6"n = Expiration_6 ,
		:"Material 7"n = Material_7 ,
		:"Source 7"n = Source_7 ,
		:"Catalog 7"n = Catalog_7,
		:"Lot 7"n = Lot_7,
		:"Expiration 7"n = Expiration_7 ,
		:"Material 8"n = Material_8,
		:"Source 8"n = Source_8 ,
		:"Catalog 8"n = Catalog_8 ,
		:"Lot 8"n = Lot_8 ,
		:"Expiration 8"n = Expiration_8,
		:"Reference Standard ID"n = ReferenceName, 
		:"RS Description"n = RSDescriptionvalue,
		:"RS Expiry"n = RSExpiryvalue,
		:"RS CF"n = ReferenceLotCF, 
		:"Stability CF"n = StabilityCF,
		:Test Article Information =talist[j] ,
		:EC50 Reference = samplesec50ref[j],
		:EC50 TA = samplesec50test[j],
		:Name("Parallelism, Slope Ratio")= finalparallellist[j],
		:Linearity Ratio =finallinearitylist[j] ,
		:Dose Test = dosetestlist[j] ,
		:Selected Model = selectedmodellist[j],
		:EC50 Fixed Setpoint = fixedRFER,
		:EC50 Reference Fixed = ec50refunconfourdose ,
		:Reference Standard Curve Depth =refcurvedepth,
		:Relative Infectivity Delta = RPdeltalist[j] ,
		:Unconstrained RI =unconsamplesrp[j] ,
		:Reportable RI =samplesrp[j] ,
		:RI Upper 95 =samplesrpu95[j] ,
		:RI Lower 95 =samplesrpl95[j] ,
		:Infectious Particles Ratio =infectparticlelist[j] ,
		:Failed Accepted Droplets = dropletsrescount,
		:Name( "CI 95% Range" ) =cirangelist[j], 
		:Name( "CI Range as % of Tolerance" ) = CItolerancelist[j],
		:Assay Validity = overallvalidity[j],
		:Delta to Target = ec50refunconfourdose - fixedRFER

		}
	));

	trackingandtrendingdt << save( concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 RI Assay Tracking and Trending.jmp") );
	Close( trackingandtrendingdt, no save );


);

//////Page break
//		pagebreaker = New Window( "     Nothing Really",
//			V List Box( String Col Box( "", {spacer} ), String Col Box( "", {spacer} ), Page Break Box(), )
//		);
//		pagebreaker << journal << close window;

//All Samples Potency Report
//Header for Combined Potency Report
potencyreportall = New Window( "     Data Display",
	V List Box(
		H List Box( String Col Box( "", {liner} ) ),
		String Col Box( "", {spacer} ),
		H List Box(
			potencyselectall = Text Box( "Relative Infectivity All Samples" ),
			String Col Box( "", {spacer} ),

		)
	),
	V List Box( H List Box( String Col Box( "", {liner} ) ), String Col Box( "", {spacer} ), ), 

);
potencyselectall << Set Font Size( 16 );
potencyselectall << Font Color( " Blue" ) << set Font Style( "Bold" ) << set Wrap( 2000 );
potencyreportall << journal << close window;

//Samples Summary All Relative Infectivity Table
dtrpall = New Table( "Potency Report" );
dtrpall << add rows( samplenum );
dtrpall << New Column( "Sample Name", character, set values( samplenames ) );
dtrpall << delete columns( :Column 1 );
dtrpall << New Column( "EC50 Standard", continuous, set values( samplesec50ref ) );
dtrpall << New Column( "EC50 Test", continuous, set values( samplesec50test ) );
dtrpall << New Column( "Infectious Ratio", continuous, Format( "Fixed Dec", 12, 1 ), set values( infectparticlelist ) );
dtrpall << New Column( "Reportable RI", continuous, Format( "Fixed Dec", 12, 1 ), set values( samplesrp ) );
dtrpall << New Column( "RI Lower 95", continuous, Format( "Fixed Dec", 12, 1 ), set values( samplesrpl95 ) );
dtrpall << New Column( "RI Upper 95", continuous, Format( "Fixed Dec", 12, 1 ), set values( samplesrpu95 ) );
dtrpall << New Column( "Stderror", continuous, formula( ((:RI Upper 95 - :Reportable RI) / 1.96) ) );
:Stderror << hide;

dtrpall << journal;
Close( dtrpall, no save );

//Samples Summary All Potency Units Table
dtpall = New Table( "Potency Report" );
dtpall << add rows( samplenum );
dtpall << New Column( "Sample Name", character, set values( samplenames ) );
dtpall << delete columns( :Column 1 );
dtpall << New Column( "Reportable RI", continuous, set values( samplesrp ) );
:Reportable RI << hide;
dtpall << New Column( "RI Lower 95", continuous, set values( samplesrpl95 ) );
:RI Lower 95 << hide;
dtpall << New Column( "RI Upper 95", continuous, set values( samplesrpu95 ) );
:RI Upper 95 << hide;

dtpall << New Column( "Overall Validity",
	Character,
	"Nominal",
	Set Property(
		"Value Colors",
		{"Assay is Valid" = -15400938, "Failed One or More Validity Criteria" = -16768477}
	),
	Color Cell by Value,
	Set Values( overallvalidity ),
	Set Display Width( 200 )
);

dtpall << New Column( "OOS",
	character,
	Set Property(
		"Value Colors",
		{"Within Limits" = -15400938, "OOS" = -15400938, "Invalid Assay Results not Reportable" = -16768477}
	),
	Color Cell by Value,
	formula( If( RPLSL <= :Reportable RI <= RPUSL, "Within Limits", "OOS" ) ),
	Set Property( "Value Colors", {"OOS" = -16768477, "Within Limits" = -15400938} ),
	Color Cell by Value, 
	 
);

If( N Rows( dtpall ) == 6,
	validitycheck = :Overall Validity << get values;
	validitycheck1 = validitycheck[1];
	validitycheck2 = validitycheck[2];
	validitycheck3 = validitycheck[3];
	validitycheck4 = validitycheck[4];
	validitycheck5 = validitycheck[5];
	validitycheck6 = validitycheck[6];

,

If( N Rows( dtpall ) == 5,
	validitycheck = :Overall Validity << get values;
	validitycheck1 = validitycheck[1];
	validitycheck2 = validitycheck[2];
	validitycheck3 = validitycheck[3];
	validitycheck4 = validitycheck[4];
	validitycheck5 = validitycheck[5];
,
	If( N Rows( dtpall ) == 4,
		validitycheck = :Overall Validity << get values;
		validitycheck1 = validitycheck[1];
		validitycheck2 = validitycheck[2];
		validitycheck3 = validitycheck[3];
		validitycheck4 = validitycheck[4];
	,
		If( N Rows( dtpall ) == 3,
			validitycheck = :Overall Validity << get values;
			validitycheck1 = validitycheck[1];
			validitycheck2 = validitycheck[2];
			validitycheck3 = validitycheck[3];
		,
			If( N Rows( dtpall ) == 2,
				validitycheck = :Overall Validity << get values;
				validitycheck1 = validitycheck[1];
				validitycheck2 = validitycheck[2];
			,
				If( N Rows( dtpall ) == 1,
					validitycheck = :Overall Validity << get values;
					validitycheck1 = validitycheck[1];
				,
					Empty()
				)
			)
		)
	)
	)
);

If( N Rows( dtpall ) == 6,
	ooscheck = :OOS << get values;
	ooscheck1 = ooscheck[1];
	ooscheck2 = ooscheck[2];
	ooscheck3 = ooscheck[3];
	ooscheck4 = ooscheck[4];
	ooscheck5 = ooscheck[5];
	ooscheck6 = ooscheck[6];
,
						
If( N Rows( dtpall ) == 5,
	ooscheck = :OOS << get values;
	ooscheck1 = ooscheck[1];
	ooscheck2 = ooscheck[2];
	ooscheck3 = ooscheck[3];
	ooscheck4 = ooscheck[4];
	ooscheck5 = ooscheck[5];
,
	If( N Rows( dtpall ) == 4,
		ooscheck = :OOS << get values;
		ooscheck1 = ooscheck[1];
		ooscheck2 = ooscheck[2];
		ooscheck3 = ooscheck[3];
		ooscheck4 = ooscheck[4];
	,
		If( N Rows( dtpall ) == 3,
			ooscheck = :OOS << get values;
			ooscheck1 = ooscheck[1];
			ooscheck2 = ooscheck[2];
			ooscheck3 = ooscheck[3];
		,
			If( N Rows( dtpall ) == 2,
				ooscheck = :OOS << get values;
				ooscheck1 = ooscheck[1];
				ooscheck2 = ooscheck[2];
			,
				If( N Rows( dtpall ) == 1,
					ooscheck = :OOS << get values;
					ooscheck1 = ooscheck[1];
				,
					Empty()
				)
			)
		)
	)
	)
);

dtpall << New Column( "Reportable",
	Character,
	"Nominal",
	Formula( If( :Overall Validity == "Assay is Valid", "Reportable", "Not Reportable" ) ),
	Set Property( "Value Colors", {"Not Reportable" = -16768477, "Reportable" = -15400938} ),
	Color Cell by Value,
	Set Display Width( 179 )
);

If( N Rows( dtpall ) == 6,
	reportables = :Reportable << get values;
	reportables1 = reportables[1];
	reportables2 = reportables[2];
	reportables3 = reportables[3];
	reportables4 = reportables[4];
	reportables5 = reportables[5];
	reportables6 = reportables[6];
,

If( N Rows( dtpall ) == 5,
	reportables = :Reportable << get values;
	reportables1 = reportables[1];
	reportables2 = reportables[2];
	reportables3 = reportables[3];
	reportables4 = reportables[4];
	reportables5 = reportables[5];
,
	If( N Rows( dtpall ) == 4,
		reportables = :Reportable << get values;
		reportables1 = reportables[1];
		reportables2 = reportables[2];
		reportables3 = reportables[3];
		reportables4 = reportables[4];
	,
		If( N Rows( dtpall ) == 3,
			reportables = :Reportable << get values;
			reportables1 = reportables[1];
			reportables2 = reportables[2];
			reportables3 = reportables[3];
		,
			If( N Rows( dtpall ) == 2,
				reportables = :Reportable << get values;
				reportables1 = reportables[1];
				reportables2 = reportables[2];
			,
				If( N Rows( dtpall ) == 1,
					reportables = :Reportable << get values;
					reportables1 = reportables[1];
				,
					Empty()
				)
			);
					
		)
	)
	)
);

dtpall << journal;

Close( dtpall, no save );


//Materials Summary
	materialsreport = New Window( "Plate Map Report",
		V List Box( H List Box( String Col Box( "", {liner} ) ) ),
		V List Box(
			String Col Box( "", {spacer} ),
			H List Box(materialsname = Text Box(concat(assaynameval," "," Bioassay Materials and Reference Standard Report")))  ,
			V List Box( H List Box( String Col Box( "", {liner} ) ) ), 

		),
		String Col Box( "", {spacer} ), 

	);
	materialsname << Set Font Size( 16 );
	materialsname << Font Color( "Blue" ) << set Font Style( "Bold" )<<set wrap(10000);
	materialsreport << journal << close window;


	tempdt = new table("",
		New Column("Column 1", Character,"Nominal",Set Values(AssayDetailsNames)),
		New Column("Column 2", Character,"Nominal",Set Values(AssayDetailsValues))
	);
	Ttempdt = tempdt << Transpose(
		columns( :Column 2 ),
		Label( :Column 1 ),
		Output Table( "Transpose of Untitled 9" )
	);
	Ttempdt << Delete Columns(1);
	
	Ttempdt << Delete Columns(13);
		
	Text Box("Assay Details") << set Font Style( "Bold" ) << set wrap(2000) << journal();
	Vspacer(1);
	Ttempdt << journal();
	
	//Get the notes column
	notesdetails=list();
	notesdetails[1]=AssayDetailsNames[13];
	
	notesvalues=list();
	notesvalues[1]=AssayDetailsValues[13];
	
		dttemp = new table("",
		New Column("Column 1", Character,"Nominal",Set Values(notesdetails)),
		New Column("Column 2", Character,"Nominal",Set Values(notesvalues))
	);
	dtnotes = dttemp << Transpose(
		columns( :Column 2 ),
		Label( :Column 1 ),
		Output Table( "Transpose of Untitled 9" )
	);
	dtnotes << Delete Columns(1);

	dtnotes<<journal();
	
	Close(dtnotes, no save);
	Close(dttemp, no save);
	Close(tempdt, No save);
	Close(Ttempdt, No save);
	Close(dtAssayInfo, No save);
	
	//Materials
	Vspacer(1);
	Text Box("Materials") << set Font Style( "Bold" ) << set wrap(2000) << journal();
	Vspacer(1);
	dtAssayInfo = Open(
		configfile,
		Worksheets( "Materials" ),
		Use for all sheets( 1 ),
		Concatenate Worksheets( 0 ),
		Create Concatenation Column( 0 ),
		Worksheet Settings(
			1,
			Has Column Headers( 1 ),
			Number of Rows in Headers( 1 ),
			Headers Start on Row( 15 ),
			Data Starts on Row( 16 ),
			Data Starts on Column( 1 ),
			Data Ends on Row( 23 ),
			Data Ends on Column( 7 ),
			Replicated Spanned Rows( 1 ),
			Replicated Spanned Headers( 0 ),
			Suppress Hidden Rows( 1 ),
			Suppress Hidden Columns( 1 ),
			Suppress Empty Columns( 0 ),
			Treat as Hierarchy( 0 ),
			Multiple Series Stack( 0 ),
			Import Cell Colors( 0 ),
			Limit Column Detect( 0 ),
			Column Separator String( "-" )
		)
	);
	:Column 7<<hide(1);
	dtAssayInfo << journal();
	Close(dtAssayInfo, No save);
	
	
		//Reference
	Vspacer(1);
	Text Box("Reference Details") << set Font Style( "Bold" ) << set wrap(2000) << journal();
	Vspacer(1);
	dtAssayInfo = Open(
		configfile,
		Worksheets( "Materials" ),
		Use for all sheets( 1 ),
		Concatenate Worksheets( 0 ),
		Create Concatenation Column( 0 ),
		Worksheet Settings(
			1,
			Has Column Headers( 1 ),
			Number of Rows in Headers( 1 ),
			Headers Start on Row( 25 ),
			Data Starts on Row( 26 ),
			Data Starts on Column( 1 ),
			Data Ends on Row( 26 ),
			Data Ends on Column( 10 ),
			Replicated Spanned Rows( 1 ),
			Replicated Spanned Headers( 0 ),
			Suppress Hidden Rows( 1 ),
			Suppress Hidden Columns( 1 ),
			Suppress Empty Columns( 0 ),
			Treat as Hierarchy( 0 ),
			Multiple Series Stack( 0 ),
			Import Cell Colors( 0 ),
			Limit Column Detect( 0 ),
			Column Separator String( "-" )
		)
	);
	dtAssayInfo << journal();
	Close(dtAssayInfo, No save);

//Save input files to report (configuration and plate file)
inputreport = New Window( "Input report",
	V List Box( H List Box( String Col Box( "", {liner} ) ) ),
	V List Box(
		String Col Box( "", {spacer} ),
		H List Box( inputname = Text Box( "   Input Files - Configuration File and Plate File(s)" ) ),
		V List Box( H List Box( String Col Box( "", {liner} ) ) ), 

	),
	String Col Box( "", {spacer} ), 

);
inputname << Set Font Size( 16 );
inputname << Font Color( 19 ) << set Font Style( "Bold" );
inputname << Set Wrap (1000);
inputreport << journal << close window;

//import the excel material template again to print on pdf report
Open(configurator, invisible);	
configfile =configurator;			
positionA = Contains( configfile , "/" , -1);//finds first position for file name
datafilenamenopath = Substr( configfile, positionA+1 );//subtracts folder path from file name

positionB = Contains( datafilenamenopath, "." );//finds last position for file name
confignamer = Substr( datafilenamenopath, 1, positionB - 1 );//final template file name

//create variables for all columns in the sample and materials info tab of the excel template
dtconfiguration= Current Data Table();

dtconfiguration << journal; 

//close first tab of configuration file
close(dtconfiguration, no save);

//Reopen the raw infection plates to journal
For( i = 1, i < platenumber + 1, i++,
	dt = Open(datafilenamerlist[i] );
	dtname[i] = dt << get name;
);

If(platenumber==1,  Data Table(dtname[1] )<< journal; close(dtname[1], no save); ,
If(platenumber==2,  Data Table(dtname[1] )<< journal; Data Table(dtname[2] )<< journal; close(dtname[1], no save); close(dtname[2], no save);,
If(platenumber==3,  Data Table(dtname[1] )<< journal; Data Table(dtname[2] )<< journal; Data Table(dtname[3] )<< journal; close(dtname[1], no save); close(dtname[2], no save); close(dtname[3], no save);,
)));


	//Set scollable displayed tables, fixes trucated data tables with last column and ensure PDF report displays all rows 
	for(aa=1, aa<=100, aa++, 
	Try(
	Current Journal()[TableBox(aa)] <<Set Scrollable(0);
	);

	);

	//create aggregate data table
	//Concatenate the main data table in to the Aggregate Raw Data Table	
	dtcd2=dttext<<select all rows<<subset(invisible);
	dtcd2 << New Column( "Source Table", Character, Nominal, Set each value(filenamer) );
	dtcd2 << New Column( "Script Version", Character, Nominal, Set each value(ScriptVer) );
	dtcd2 << select columns("Source Table") << Move Selected Column( to first );
	dtconcat = Open(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 Aggregate Raw Data Table.jmp"));
	dtconcat  << Concatenate( dtcd2, "Append to First Table");
	dtconcat<<clear row states;	dtconcat<<clear row states;
	dtconcat << select columns("Source Table") << Move Selected Column( to first );
	:Source Table<<Set Display Width( 400 );
	dtconcat<<clear row states;
	dtconcat << save(concat(pathlocation,"Astellas KT430 RI Assay Results\Tracking\Astellas KT430 Aggregate Raw Data Table.jmp"));

	close(dtconcat, no save);
	close(dtcd2, no save);


//Define setup information to save in pdf
//get the date stamp for the file name
datetimestamper = Substitute( Char( dateint ), ":", "-" );
Current Journal() << Set Window Title( Concat( filenamer || "_" || datetimestamper ) );
winJOURNAL = Current Journal();

//Define setup information to save in pdf
winJOURNAL << Set Print Footers(
	"&d;"/*left*/,
	"Astellas Therapeutics Proprietary and Confidential"/*center*/,
	"Page &pn; of &pc;"/*right*/
);
headerleft = Concat( filenamer || "_" || datetimestamper );
winJOURNAL << Set Print Headers( headerleft, "", "" );



winJOURNAL << Set page setup(

	margins( 0.5, 0.5, 0.5, 0.5 ), 

	scale( 0.5 ), 

	portrait( 1 ), 

	paper size( "A3" )

);



winJOURNAL << get page setup();

	//Set the file name and footer
	if(nitems(dtname)==1,
	ReportName = concat(dtname[1]|| "_Report_"||datetimestamper);
	,
	if(nitems(dtname)==2,
		ReportName = concat(dtname[1]||"_"||dtname[2]|| "_Report_"||datetimestamper);
,
		ReportName = concat(dtname[1]||"_"||dtname[2]||"_"||dtname[3]|| "_Report_"||datetimestamper);
	);
	);
	presentjournal = winJOURNAL;
	presentjournal << Set Window Title( ReportName ) ;
	presentjournal << Set Print Footers( concat("© 2023 - ",char(Year( Today() ))," BioAssay Sciences, Thomas A. Little Consulting" ));

	//Define setup information to save in pdf
	presentjournal << Set page setup(
		margins( 0.5, 0.5, 0.5, 0.5 ), 
		scale( 0.45 ), 
		portrait( 1 ), 
		paper size( "A3" )
	);
	


	//Save pdf and journal
	presentjournal << Save PDF( concat(pathlocation, "Astellas KT430 RI Assay Results\PDFs\") || ReportName || ".pdf" );
	presentjournal << Save Journal(concat(pathlocation, "Astellas KT430 RI Assay Results\Journals\") || ReportName || ".jrn");
	presentjournal << close window(1);

//Save pdf journal and data file to chosen file from the preset JMP Preferences
savepath = Char( Get Preferences() );
positionB = Contains( savepath, "Save As Directory" );
savepathfinal = Substr( savepath, positionB );

positionC = Contains( savepathfinal, "\!"" );
positionD = Contains( savepathfinal, "\!"", 1 + positionC );

savepathfinal = Substr( savepathfinal, 1 + positionC, positionD - (1 + positionC) );



Current Journal() << close window;

	Close(dttextsum2, Save(concat(pathlocation, "Astellas KT430 RI Assay Results\Tables\") ||ReportName || ".jmp"));
	Close(dttext, Save(concat(pathlocation, "Astellas KT430 RI Assay Results\Tables\") ||ReportName || ".jmp"));

Close All( data tables );

	if(contains(JMP version(),"15")
	,
	//Closes the report window in JMP 15 or JMP 16
	ReportList = Get Window List( type(Reports) );
	If( N items(Reportlist )>0,
		For( i=1, i<= N Items( reportlist ), i++,
		ReportList[i] << Close Window(); 
		);
	);
	,
	empty();
	
	);
	New Window( "Script Status",
	<<modal,
	Text Box( "Bioassay script is complete." ),
	Text Box( "PDF Report, Journal and JMP files are in the folder" )
	);

	fontpref;//set fonts back to user font preferences
	tablestyles;//set table styles back to user table style preferences
